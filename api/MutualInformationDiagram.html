<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>MutualInformationDiagram | ParaViewWeb</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://kitware.github.io/paraviewweb/api/MutualInformationDiagram.html">
  <!-- Alternative links -->
  
    
      <link rel="alternative" hreflang="en" href="https://kitware.github.io/paraviewweb/api/MutualInformationDiagram.html">
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/paraviewweb/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/paraviewweb/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/paraviewweb/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/paraviewweb/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/paraviewweb/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/paraviewweb/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/paraviewweb/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/paraviewweb/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/paraviewweb/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/paraviewweb/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/paraviewweb/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/paraviewweb/atom.xml" title="ParaViewWeb">
  <!-- Open Graph -->
  <meta name="description" content="Sourcebody.html&amp;lt;div class=&quot;info-diagram-container&quot;&amp;gt;  &amp;lt;div class=&quot;info-diagram-placeholder&quot;&amp;gt;    &amp;lt;div class=&quot;id-placeholder-row&quot;&amp;gt;      &amp;lt;span class=&quot;id-placeholder-title&quot;&amp;gt;Informat">
<meta property="og:type" content="website">
<meta property="og:title" content="MutualInformationDiagram">
<meta property="og:url" content="https://kitware.github.io/paraviewweb/api/MutualInformationDiagram.html">
<meta property="og:site_name" content="ParaViewWeb">
<meta property="og:description" content="Sourcebody.html&amp;lt;div class=&quot;info-diagram-container&quot;&amp;gt;  &amp;lt;div class=&quot;info-diagram-placeholder&quot;&amp;gt;    &amp;lt;div class=&quot;id-placeholder-row&quot;&amp;gt;      &amp;lt;span class=&quot;id-placeholder-title&quot;&amp;gt;Informat">
<meta property="og:updated_time" content="2016-10-31T17:05:27.774Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MutualInformationDiagram">
<meta name="twitter:description" content="Sourcebody.html&amp;lt;div class=&quot;info-diagram-container&quot;&amp;gt;  &amp;lt;div class=&quot;info-diagram-placeholder&quot;&amp;gt;    &amp;lt;div class=&quot;id-placeholder-row&quot;&amp;gt;      &amp;lt;span class=&quot;id-placeholder-title&quot;&amp;gt;Informat">
  <!-- Google Analytics -->
  
</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/paraviewweb/" id="logo">ParaViewWeb</a>
    </h1>
    <nav id="main-nav">
      <a href="/paraviewweb/docs/" class="main-nav-link">Docs</a><a href="/paraviewweb/api/" class="main-nav-link">API</a><a href="/paraviewweb/examples/" class="main-nav-link">Examples</a><a href="/paraviewweb/applications/" class="main-nav-link">Applications</a>
      <a href="https://github.com/kitware/paraviewweb" class="main-nav-link"><i class="fa fa-github-alt"></i></a>
      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">MutualInformationDiagram</h1>
              </header>
              <div class="article-content" itemprop="articleBody">
                <h1 id="Source" class="article-heading"><a href="#Source" class="headerlink" title="Source"></a>Source<a class="article-anchor" href="#Source" aria-hidden="true"></a></h1><figure class="highlight js"><figcaption><span>body.html</span></figcaption><table><tr><td class="code"><pre><div class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"info-diagram-container"</span>&gt;</div><div class="line">  &lt;div class="info-diagram-placeholder"&gt;</div><div class="line">    &lt;div class="id-placeholder-row"&gt;</div><div class="line">      &lt;span class="id-placeholder-title"&gt;Information Diagram&lt;/span&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div class="id-placeholder-row"&gt;</div><div class="line">      &lt;img class="id-placeholder-image"/&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div class="id-placeholder-row"&gt;</div><div class="line">      &lt;span class="id-placeholder-info"&gt;Please select two or more variables&lt;/span&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">  &lt;div class="status-bar-container"&gt;</div><div class="line">    &lt;div class="status-bar"&gt;</div><div class="line">      &lt;i class="show-button"&gt;&lt;/i&gt;</div><div class="line">      &lt;i class="hide-button"&gt;&lt;/i&gt;</div><div class="line">      &lt;input type="text" class="status-bar-text" readonly="true" /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<figure class="highlight"><figcaption><span>index.js</span></figcaption><table><tr><td class="code"><pre><div class="line">/* global document */</div><div class="line">import d3 from 'd3';</div><div class="line"></div><div class="line">import style from 'PVWStyle/InfoVizNative/InformationDiagram.mcss';</div><div class="line"></div><div class="line">import CompositeClosureHelper from '../../../Common/Core/CompositeClosureHelper';</div><div class="line">import htmlContent from './body.html';</div><div class="line">import iconImage from './InfoDiagramIconSmall.png';</div><div class="line">// import multiClicker from '../../Core/D3MultiClick';</div><div class="line">import SelectionBuilder from '../../../Common/Misc/SelectionBuilder';</div><div class="line">import AnnotationBuilder from '../../../Common/Misc/AnnotationBuilder';</div><div class="line"></div><div class="line">import &#123;</div><div class="line">  calculateAngleAndRadius,</div><div class="line">  downsample,</div><div class="line">  freqToProb,</div><div class="line">  topBinPmi,</div><div class="line">  topPmi,</div><div class="line">&#125; from './utils';</div><div class="line"></div><div class="line">const PMI_CHORD_MODE_NONE = 0;</div><div class="line">const PMI_CHORD_MODE_ONE_BIN_ALL_VARS = 1;</div><div class="line">const PMI_CHORD_MODE_ALL_BINS_TWO_VARS = 2;</div><div class="line"></div><div class="line">let miCount = 0;</div><div class="line"></div><div class="line">/* eslint-disable no-use-before-define */</div><div class="line"></div><div class="line">// ----------------------------------------------------------------------------</div><div class="line">// Information Diagram</div><div class="line">// ----------------------------------------------------------------------------</div><div class="line"></div><div class="line">function informationDiagram(publicAPI, model) &#123;</div><div class="line">  let lastAnnotationPushed = null;</div><div class="line"></div><div class="line">  if (!model.provider</div><div class="line">    || !model.provider.isA('MutualInformationProvider')</div><div class="line">    || !model.provider.isA('Histogram1DProvider')</div><div class="line">    || !model.provider.isA('FieldProvider')) &#123;</div><div class="line">    console.log('Invalid provider:', model.provider);</div><div class="line">    return;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  model.renderState = &#123;</div><div class="line">    pmiAllBinsTwoVars: null,</div><div class="line">    pmiOneBinAllVars: null,</div><div class="line">    pmiHighlight: null,</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  model.clientRect = null;</div><div class="line"></div><div class="line">  miCount += 1;</div><div class="line">  // unique id, based on count</div><div class="line">  model.instanceID = `pvwInformationDiagram-$&#123;miCount&#125;`;</div><div class="line"></div><div class="line">  // Handle style for status bar</div><div class="line">  function updateStatusBarVisibility() &#123;</div><div class="line">    const cntnr = d3.select(model.container);</div><div class="line">    if (model.statusBarVisible) &#123;</div><div class="line">      cntnr.select('.status-bar-container')</div><div class="line">        .style('width', function updateWidth() &#123; return this.dataset.width; &#125;);</div><div class="line">      cntnr.select('.show-button').classed(style.hidden, true);</div><div class="line">      cntnr.select('.hide-button').classed(style.hidden, false);</div><div class="line">      cntnr.select('.status-bar-text').classed(style.hidden, false);</div><div class="line">    &#125; else &#123;</div><div class="line">      cntnr.select('.status-bar-container').style('width', '20px');</div><div class="line">      cntnr.select('.show-button').classed(style.hidden, false);</div><div class="line">      cntnr.select('.hide-button').classed(style.hidden, true);</div><div class="line">      cntnr.select('.status-bar-text').classed(style.hidden, true);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  publicAPI.propagateAnnotationInsteadOfSelection = (useAnnotation = true, defaultScore = 0, defaultWeight = 0) =&gt; &#123;</div><div class="line">    model.useAnnotation = useAnnotation;</div><div class="line">    model.defaultScore = defaultScore;</div><div class="line">    model.defaultWeight = defaultWeight;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  publicAPI.resize = () =&gt; &#123;</div><div class="line">    if (!model.container) &#123;</div><div class="line">      return; // no shirt, no shoes, no service.</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    model.clientRect = model.container.getBoundingClientRect();</div><div class="line"></div><div class="line">    d3.select(model.container)</div><div class="line">      .select('div.status-bar-container')</div><div class="line">      .attr('data-width', `$&#123;model.clientRect.width - 20&#125;px`);</div><div class="line"></div><div class="line">    publicAPI.render();</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  publicAPI.setContainer = (el) =&gt; &#123;</div><div class="line">    if (model.container) &#123;</div><div class="line">      while (model.container.firstChild) &#123;</div><div class="line">        model.container.removeChild(model.container.firstChild);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    model.container = el;</div><div class="line"></div><div class="line">    if (model.container) &#123;</div><div class="line">      // Create placeholder</div><div class="line">      model.container.innerHTML = htmlContent;</div><div class="line"></div><div class="line">      // Apply style</div><div class="line">      const d3Container = d3</div><div class="line">        .select(model.container)</div><div class="line">        .select('.info-diagram-container')</div><div class="line">        .classed(style.infoDiagramContainer, true);</div><div class="line"></div><div class="line">      d3Container</div><div class="line">        .select('.status-bar-container')</div><div class="line">        .classed(style.statusBarContainer, true);</div><div class="line"></div><div class="line">      d3Container</div><div class="line">        .select('.status-bar-text')</div><div class="line">        .classed(style.statusBarText, true);</div><div class="line"></div><div class="line">      d3Container</div><div class="line">        .select('.show-button')</div><div class="line">        .classed(style.showButton, true);</div><div class="line"></div><div class="line">      d3Container</div><div class="line">        .select('.hide-button')</div><div class="line">        .classed(style.hideButton, true);</div><div class="line"></div><div class="line">      d3Container</div><div class="line">        .select('.info-diagram-placeholder')</div><div class="line">        .classed(style.infoDiagramPlaceholder, true)</div><div class="line">        .select('img')</div><div class="line">        .attr('src', iconImage);</div><div class="line"></div><div class="line">      // Attach listener for show/hide status bar</div><div class="line">      d3Container.selectAll('.show-button, .hide-button').on('click', () =&gt; &#123;</div><div class="line">        model.statusBarVisible = !model.statusBarVisible;</div><div class="line">        updateStatusBarVisibility();</div><div class="line">        d3.event.preventDefault();</div><div class="line">        d3.event.stopPropagation();</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">      updateStatusBarVisibility();</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  publicAPI.updateStatusBarText = msg =&gt; d3.select(model.container).select('input.status-bar-text').attr('value', msg);</div><div class="line"></div><div class="line">  publicAPI.selectStatusBarText = () =&gt; &#123;</div><div class="line">    // select text so user can press ctrl-c if desired.</div><div class="line">    if (model.statusBarVisible) &#123;</div><div class="line">      // https://www.sitepoint.com/javascript-copy-to-clipboard/</div><div class="line">      d3.select(model.container).select('input.status-bar-text').node().select();</div><div class="line">      // Copy-to-clipboard works because status bar text is an 'input':</div><div class="line">      try &#123;</div><div class="line">        document.execCommand('copy');</div><div class="line">      &#125; catch (err) &#123;</div><div class="line">        console.log('Copy to clipboard failed. Press Ctrl-C to copy');</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  // need a unique groupID whenever a group is added.</div><div class="line">  let groupID = 0;</div><div class="line"></div><div class="line">  publicAPI.render = () =&gt; &#123;</div><div class="line">    // Extract provider data for local access</div><div class="line">    const getLegend = model.provider.isA('LegendProvider') ? model.provider.getLegend : null;</div><div class="line">    const histogram1DnumberOfBins = model.numberOfBins;</div><div class="line">    const variableList = model.provider.getActiveFieldNames();</div><div class="line"></div><div class="line">    if (variableList.length &lt; 2 || !model.container) &#123;</div><div class="line">      // Select the main circle and hide it and unhide placeholder</div><div class="line">      d3.select(model.container).select('svg.information-diagram')</div><div class="line">        .classed(style.informationDiagramSvgShow, false)</div><div class="line">        .classed(style.informationDiagramSvgHide, true);</div><div class="line">      d3.select(model.container).select('div.info-diagram-placeholder').classed(style.hidden, false);</div><div class="line">      publicAPI.updateStatusBarText('');</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Guard against rendering if container is non-null but has no size (as</div><div class="line">    // in the case when workbench layout doesn't include our container)</div><div class="line">    if (model.clientRect === null || model.clientRect.width === 0 || model.clientRect.height === 0) &#123;</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    const width = model.clientRect.width;</div><div class="line">    const height = model.clientRect.height;</div><div class="line"></div><div class="line">    // Make sure we have all the data we need</div><div class="line">    if (!model.mutualInformationData || !model.histogramData) &#123;</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Update</div><div class="line">    updateStatusBarVisibility();</div><div class="line"></div><div class="line">    d3.select(model.container).select('div.info-diagram-placeholder').classed(style.hidden, true);</div><div class="line">    d3.select(model.container).select('svg.information-diagram')</div><div class="line">      .classed(style.informationDiagramSvgHide, false)</div><div class="line">      .classed(style.informationDiagramSvgShow, true);</div><div class="line"></div><div class="line">    const pmiChordMode = &#123;</div><div class="line">      mode: PMI_CHORD_MODE_NONE,</div><div class="line">      srcParam: null,</div><div class="line">      srcBin: null,</div><div class="line">      miIndex: -1,</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    const outerHistoRadius = Math.min(width, height) / 2;</div><div class="line">    const veryOutermostRadius = outerHistoRadius + 80;</div><div class="line">    const histoRadius = outerHistoRadius - 20;</div><div class="line">    const outerRadius = histoRadius - 50;</div><div class="line">    const innerRadius = outerRadius - 24;</div><div class="line">    const deltaRadius = outerRadius - innerRadius;</div><div class="line"></div><div class="line">    const formatPercent = d3.format('.1%');</div><div class="line">    const formatMI = d3.format('.2f');</div><div class="line">    const formatVal = d3.format('.2s');</div><div class="line"></div><div class="line">    const arc = d3.svg.arc()</div><div class="line">      .innerRadius(innerRadius)</div><div class="line">      .outerRadius(outerRadius);</div><div class="line"></div><div class="line">    const histoArc = d3.svg.arc().innerRadius(outerRadius + 10);</div><div class="line"></div><div class="line">    const layout = d3</div><div class="line">      .layout</div><div class="line">      .chord()</div><div class="line">      .padding(0.04)</div><div class="line">      .sortSubgroups(d3.descending)</div><div class="line">      .sortChords(d3.ascending);</div><div class="line"></div><div class="line">    const path = d3.svg.chord().radius(innerRadius);</div><div class="line"></div><div class="line">    // Remove previous SVG</div><div class="line">    let svgParent = d3.select(model.container).select('svg');</div><div class="line">    let svg = svgParent.select('.main-circle');</div><div class="line">    if (svgParent.empty()) &#123;</div><div class="line">      svgParent = d3.select(model.container).append('svg')</div><div class="line">      .style('float', 'left')</div><div class="line">      .attr('class', style.informationDiagramSvgShow)</div><div class="line">      .classed('information-diagram', true);</div><div class="line">      svg = svgParent.append('g')</div><div class="line">      .classed('main-circle', true)</div><div class="line">      .classed(style.mainCircle, true);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    svgParent</div><div class="line">      .attr('width', width)</div><div class="line">      .attr('height', height);</div><div class="line">    svg</div><div class="line">      .attr('transform', `translate($&#123;width / 2&#125;, $&#123;height / 2&#125;)`);</div><div class="line"></div><div class="line">    function findGroupAndBin(relCoords) &#123;</div><div class="line">      const result = &#123;</div><div class="line">        found: false,</div><div class="line">        group: null,</div><div class="line">        bin: -1,</div><div class="line">        radius: 0,</div><div class="line">      &#125;;</div><div class="line">      const [angle, radius] = calculateAngleAndRadius(relCoords, [width, height]);</div><div class="line">      result.radius = radius;</div><div class="line">      for (let groupIdx = 0; groupIdx &lt; layout.groups().length; ++groupIdx) &#123;</div><div class="line">        const groupData = layout.groups()[groupIdx];</div><div class="line">        const groupName = model.mutualInformationData.vmap[groupData.index].name;</div><div class="line">        if (angle &gt; groupData.startAngle &amp;&amp; angle &lt;= groupData.endAngle) &#123;</div><div class="line">          const binSizeRadians = (groupData.endAngle - groupData.startAngle) / model.numberOfBins;</div><div class="line">          const binIndex = Math.floor((angle - groupData.startAngle) / binSizeRadians);</div><div class="line">          result.found = true;</div><div class="line">          result.group = groupName;</div><div class="line">          result.bin = binIndex;</div><div class="line">          break;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function unHoverBin(param) &#123;</div><div class="line">      if (model.provider.isA('HistogramBinHoverProvider')) &#123;</div><div class="line">        const state = &#123;&#125;;</div><div class="line">        state[param] = [-1];</div><div class="line">        model.provider.setHoverState(&#123;</div><div class="line">          source: 'MutualInformationDiagram',</div><div class="line">          state,</div><div class="line">        &#125;);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function hoverBins(binMap) &#123;</div><div class="line">      if (model.provider.isA('HistogramBinHoverProvider')) &#123;</div><div class="line">        model.provider.setHoverState(&#123;</div><div class="line">          source: 'MutualInformationDiagram',</div><div class="line">          state: binMap,</div><div class="line">        &#125;);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function updateActiveSelection(binMap) &#123;</div><div class="line">      if (!model.provider.isA('SelectionProvider') || !model.provider.isA('FieldProvider')) &#123;</div><div class="line">        return;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      const vars = &#123;&#125;;</div><div class="line">      let proceed = false;</div><div class="line"></div><div class="line">      Object.keys(binMap).forEach((pName) =&gt; &#123;</div><div class="line">        const paramRange = model.provider.getField(pName).range;</div><div class="line">        const binList = binMap[pName];</div><div class="line">        const rangeList = [];</div><div class="line">        for (let i = 0; i &lt; binList.length; ++i) &#123;</div><div class="line">          if (binList[i] !== -1) &#123;</div><div class="line">            rangeList.push(&#123;</div><div class="line">              interval: getBinRange(binList[i], histogram1DnumberOfBins, [paramRange[0], paramRange[1], paramRange[1] - paramRange[0]]),</div><div class="line">            &#125;);</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">        if (rangeList.length &gt; 0) &#123;</div><div class="line">          proceed = true;</div><div class="line">          vars[pName] = rangeList;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">      if (proceed) &#123;</div><div class="line">        const selection = SelectionBuilder.range(vars);</div><div class="line">        if (model.useAnnotation) &#123;</div><div class="line">          lastAnnotationPushed = model.provider.getAnnotation();</div><div class="line">          if (!lastAnnotationPushed || model.provider.shouldCreateNewAnnotation() || lastAnnotationPushed.selection.type !== 'range') &#123;</div><div class="line">            lastAnnotationPushed = AnnotationBuilder.annotation(selection, [model.defaultScore], model.defaultWeight);</div><div class="line">          &#125; else &#123;</div><div class="line">            lastAnnotationPushed = AnnotationBuilder.update(lastAnnotationPushed, &#123;</div><div class="line">              selection,</div><div class="line">              score: [model.defaultScore],</div><div class="line">              weight: model.defaultWeight,</div><div class="line">            &#125;);</div><div class="line">          &#125;</div><div class="line">          AnnotationBuilder.updateReadOnlyFlag(lastAnnotationPushed, model.readOnlyFields);</div><div class="line">          model.provider.setAnnotation(lastAnnotationPushed);</div><div class="line">        &#125; else &#123;</div><div class="line">          model.provider.setSelection(selection);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // function findPmiChordsToHighlight(param, bin, highlight = true, oneBinAllVarsMode = false) &#123;</div><div class="line">    function findPmiChordsToHighlight() &#123;</div><div class="line">      const &#123; group: param, bin, highlight, mode: oneBinAllVarsMode &#125; = model.renderState.pmiHighlight;</div><div class="line">      if (highlight) &#123;</div><div class="line">        svg.select('g.pmiChords')</div><div class="line">          .selectAll('path.pmiChord')</div><div class="line">          .classed('highlight-pmi', false);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      const binMap = &#123;&#125;;</div><div class="line"></div><div class="line">      function addBin(pName, bIdx) &#123;</div><div class="line">        if (!binMap[pName]) &#123;</div><div class="line">          binMap[pName] = [];</div><div class="line">        &#125;</div><div class="line">        if (binMap[pName].indexOf(bIdx) === -1) &#123;</div><div class="line">          binMap[pName].push(bIdx);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      if (oneBinAllVarsMode) &#123;</div><div class="line">        svg.select('g.pmiChords').selectAll(`path[data-source-name="$&#123;param&#125;"]:not(.fade)`)</div><div class="line">          .classed('highlight-pmi', highlight)</div><div class="line">          .each(function highlightPMI(d, i) &#123;</div><div class="line">            const elt = d3.select(this);</div><div class="line">            addBin(param, bin);</div><div class="line">            addBin(elt.attr('data-target-name'), Number.parseInt(elt.attr('data-target-bin'), 10));</div><div class="line">          &#125;);</div><div class="line"></div><div class="line">        svg.select('g.pmiChords')</div><div class="line">          .selectAll(`path[data-target-name="$&#123;param&#125;"]:not(.fade)`)</div><div class="line">          .each(function inner(d, i) &#123;</div><div class="line">            const elt = d3.select(this);</div><div class="line">            addBin(param, Number.parseInt(elt.attr('data-target-bin'), 10));</div><div class="line">            addBin(elt.attr('data-source-name'), Number.parseInt(elt.attr('data-source-bin'), 10));</div><div class="line">          &#125;);</div><div class="line"></div><div class="line">        if (binMap[param] &amp;&amp; binMap[param].indexOf(bin) &gt;= 0) &#123;</div><div class="line">          binMap[param] = [bin];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        svg.select('g.pmiChords').selectAll(`path[data-target-name="$&#123;param&#125;"]:not(.fade)`)</div><div class="line">          .classed('highlight-pmi', function inner(d, i) &#123;</div><div class="line">            const elt = d3.select(this);</div><div class="line">            return binMap[param].indexOf(Number.parseInt(elt.attr('data-target-bin'), 10)) &gt;= 0;</div><div class="line">          &#125;);</div><div class="line">      &#125; else &#123;</div><div class="line">        svg.select('g.pmiChords').selectAll(`path[data-source-name="$&#123;param&#125;"][data-source-bin="$&#123;bin&#125;"]:not(.fade)`)</div><div class="line">        .classed('highlight-pmi', highlight)</div><div class="line">        .each(function highlightPMI(d, i) &#123;</div><div class="line">          const elt = d3.select(this);</div><div class="line">          addBin(param, bin);</div><div class="line">          addBin(elt.attr('data-target-name'), Number.parseInt(elt.attr('data-target-bin'), 10));</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        svg.select('g.pmiChords').selectAll(`path[data-target-name="$&#123;param&#125;"][data-target-bin="$&#123;bin&#125;"]:not(.fade)`)</div><div class="line">          .classed('highlight-pmi', highlight)</div><div class="line">          .each(function highlightPMI(d, i) &#123;</div><div class="line">            const elt = d3.select(this);</div><div class="line">            addBin(param, bin);</div><div class="line">            addBin(elt.attr('data-source-name'), Number.parseInt(elt.attr('data-source-bin'), 10));</div><div class="line">          &#125;);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      return binMap;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Chord handling ---------------------------------------------------------</div><div class="line"></div><div class="line">    function updateChordVisibility(options) &#123;</div><div class="line">      if (options.mi &amp;&amp; options.mi.show === true) &#123;</div><div class="line">        if (options.mi.index !== undefined) &#123;</div><div class="line">          chord.classed('fade', p =&gt; p.source.index !== options.mi.index &amp;&amp; p.target.index !== options.mi.index);</div><div class="line">        &#125; else &#123;</div><div class="line">          chord.classed('fade', false);</div><div class="line">        &#125;</div><div class="line">        svg.selectAll('g.pmiChords path.pmiChord').classed('fade', true);</div><div class="line">      &#125; else if (options.pmi &amp;&amp; options.pmi.show === true) &#123;</div><div class="line">        // Currently drawing pmi chords fades all mi chords, so we</div><div class="line">        // don't have to do anything here to keep things consistent.</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function drawPMIAllBinsTwoVars() &#123;</div><div class="line">      const d = model.renderState.pmiAllBinsTwoVars.d;</div><div class="line">      if (d.source.index === d.target.index) &#123;</div><div class="line">        console.log('Cannot render self-PMI', model.mutualInformationData.vmap[d.source.index].name);</div><div class="line">        return;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      pmiChordMode.mode = PMI_CHORD_MODE_ALL_BINS_TWO_VARS;</div><div class="line">      pmiChordMode.srcParam = null;</div><div class="line">      pmiChordMode.srcBin = null;</div><div class="line"></div><div class="line">      // Turn off MI rendering</div><div class="line">      chord.classed('fade', true);</div><div class="line">      // Turn on PMI rendering</div><div class="line">      let va = model.mutualInformationData.vmap[d.source.index].name;</div><div class="line">      let vb = model.mutualInformationData.vmap[d.target.index].name;</div><div class="line">      let swap = false;</div><div class="line">      if (vb &lt; va) &#123;</div><div class="line">        const tmp = vb;</div><div class="line">        vb = va;</div><div class="line">        va = tmp;</div><div class="line">        swap = true;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      const cAB = downsample(model.mutualInformationData.joint[va][vb], histogram1DnumberOfBins, swap);</div><div class="line">      const probDict = freqToProb(cAB);</div><div class="line">      const linksToDraw = topPmi(probDict, 0.95);</div><div class="line"></div><div class="line">      // Make mutual info chords invisible.</div><div class="line">      svg.selectAll('g.group path.chord')</div><div class="line">        .classed('fade', true);</div><div class="line"></div><div class="line">      const linkData = svg.select('g.pmiChords')</div><div class="line">        .selectAll('path.pmiChord')</div><div class="line">        .data(d3.zip(linksToDraw.idx, linksToDraw.pmi,</div><div class="line">          new Array(linksToDraw.idx.length).fill([va, vb])));</div><div class="line"></div><div class="line">      linkData</div><div class="line">        .enter()</div><div class="line">        .append('path')</div><div class="line">        .classed('pmiChord', true)</div><div class="line">        .classed(style.pmiChord, true);</div><div class="line">      linkData.exit().remove();</div><div class="line"></div><div class="line">      const vaGroup = layout.groups()[d.source.index];</div><div class="line">      const vbGroup = layout.groups()[d.target.index];</div><div class="line">      const vaRange = [vaGroup.startAngle, (vaGroup.endAngle - vaGroup.startAngle), (vaGroup.endAngle - vaGroup.startAngle) / histogram1DnumberOfBins];</div><div class="line">      const vbRange = [vbGroup.startAngle, (vbGroup.endAngle - vbGroup.startAngle), (vbGroup.endAngle - vbGroup.startAngle) / histogram1DnumberOfBins];</div><div class="line"></div><div class="line">      linkData</div><div class="line">        .classed('fade', false)</div><div class="line">        .attr('d', (data, index) =&gt;</div><div class="line">          path(&#123;</div><div class="line">            source: &#123;</div><div class="line">              startAngle: (vaRange[0] + (data[0][0] * vaRange[2])),</div><div class="line">              endAngle: (vaRange[0] + ((data[0][0] + 1) * vaRange[2])),</div><div class="line">            &#125;,</div><div class="line">            target: &#123;</div><div class="line">              startAngle: (vbRange[0] + (data[0][1] * vbRange[2])),</div><div class="line">              endAngle: (vbRange[0] + ((data[0][1] + 1) * vbRange[2])),</div><div class="line">            &#125;,</div><div class="line">          &#125;)</div><div class="line">        )</div><div class="line">        .attr('data-source-name', swap ? vb : va)</div><div class="line">        .attr('data-source-bin', (data, index) =&gt; `$&#123;data[0][0]&#125;`)</div><div class="line">        .attr('data-target-name', swap ? va : vb)</div><div class="line">        .attr('data-target-bin', (data, iindex) =&gt; `$&#123;data[0][1]&#125;`)</div><div class="line">        .classed('highlight-pmi', false)</div><div class="line">        .classed('positive', (data, index) =&gt; data[1] &gt;= 0.0)</div><div class="line">        .classed('negative', (data, index) =&gt; data[1] &lt; 0.0)</div><div class="line">        .attr('data-details', (data, index) =&gt; &#123;</div><div class="line">          var sIdx = swap ? 1 : 0;</div><div class="line">          var tIdx = swap ? 0 : 1;</div><div class="line">          const sourceBinRange = getParamBinRange(data[0][sIdx], histogram1DnumberOfBins, data[2][0]);</div><div class="line">          const targetBinRange = getParamBinRange(data[0][tIdx], histogram1DnumberOfBins, data[2][1]);</div><div class="line">          return 'PMI: '</div><div class="line">            + `$&#123;data[2][0]&#125; ∈ [ $&#123;formatVal(sourceBinRange[0])&#125;, $&#123;formatVal(sourceBinRange[1])&#125;] ↔︎ `</div><div class="line">            + `$&#123;data[2][1]&#125; ∈ [ $&#123;formatVal(targetBinRange[0])&#125;, $&#123;formatVal(targetBinRange[1])&#125;] $&#123;formatMI(data[1])&#125;`;</div><div class="line">        &#125;)</div><div class="line">        .on('mouseover', function mouseOver() &#123;</div><div class="line">          publicAPI.updateStatusBarText(d3.select(this).attr('data-details'));</div><div class="line">        &#125;)</div><div class="line">        .on('mouseout', () =&gt; &#123;</div><div class="line">          publicAPI.updateStatusBarText('');</div><div class="line">        &#125;)</div><div class="line">        .on('click', () =&gt; &#123; publicAPI.selectStatusBarText(); &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Mouse move handling ----------------------------------------------------</div><div class="line"></div><div class="line">    svgParent</div><div class="line">      /* eslint-disable prefer-arrow-callback */</div><div class="line">      // need d3 provided 'this', below.</div><div class="line">      .on('mousemove', function mouseMove(d, i) &#123;</div><div class="line">        /* xxeslint-enable prefer-arrow-callback */</div><div class="line">        const overCoords = d3.mouse(model.container);</div><div class="line">        const info = findGroupAndBin(overCoords);</div><div class="line">        let clearStatusBar = false;</div><div class="line">        let groupHoverName = null;</div><div class="line">        let highlightAllGroups = false;</div><div class="line"></div><div class="line">        for (let idx = 0; idx &lt; variableList.length; ++idx) &#123;</div><div class="line">          unHoverBin(variableList[idx]);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (info.radius &gt; veryOutermostRadius) &#123;</div><div class="line">          highlightAllGroups = true;</div><div class="line">          clearStatusBar = true;</div><div class="line">        &#125; else if (info.found) &#123;</div><div class="line">          if (info.radius &gt; innerRadius &amp;&amp; info.radius &lt;= outerRadius) groupHoverName = info.group;</div><div class="line"></div><div class="line">          let binMap = &#123;&#125;;</div><div class="line">          if (!(info.radius &lt;= innerRadius &amp;&amp; pmiChordMode.mode === PMI_CHORD_MODE_NONE)) &#123;</div><div class="line">            const oneBinAllVarsMode = info.radius &lt;= innerRadius &amp;&amp; pmiChordMode.mode === PMI_CHORD_MODE_ONE_BIN_ALL_VARS;</div><div class="line">            model.renderState.pmiHighlight = &#123; group: info.group, bin: info.bin, highlight: true, mode: oneBinAllVarsMode &#125;;</div><div class="line">            const pmiBinMap = findPmiChordsToHighlight();</div><div class="line">            if (info.radius &lt;= innerRadius) &#123;</div><div class="line">              binMap = pmiBinMap;</div><div class="line">            &#125; else &#123;</div><div class="line">              svg.select(`g.group[param-name='$&#123;info.group&#125;'`)</div><div class="line">                .selectAll('path.htile')</div><div class="line">                .each(function hTileInner(data, index) &#123;</div><div class="line">                  if (index === info.bin) &#123;</div><div class="line">                    publicAPI.updateStatusBarText(d3.select(this).attr('data-details'));</div><div class="line">                  &#125;</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">            if (!oneBinAllVarsMode) &#123;</div><div class="line">              binMap[info.group] = [info.bin];</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">          hoverBins(binMap);</div><div class="line">        &#125; else &#123;</div><div class="line">          clearStatusBar = true;</div><div class="line">        &#125;</div><div class="line">        // show a clickable variable legend arc, if hovered, or</div><div class="line">        // highlight all groups if a click will reset to default view (veryOutermostRadius)</div><div class="line">        svg</div><div class="line">          .selectAll(`g.group path[id^=\'$&#123;model.instanceID&#125;-group\']`)</div><div class="line">          .classed(style.hoverOutline, (data, idx) =&gt; highlightAllGroups || model.mutualInformationData.vmap[idx].name === groupHoverName);</div><div class="line"></div><div class="line">        if (clearStatusBar === true) &#123;</div><div class="line">          publicAPI.updateStatusBarText('');</div><div class="line">        &#125;</div><div class="line">      &#125;)</div><div class="line">      .on('mouseout', (d, i) =&gt; &#123;</div><div class="line">        for (let idx = 0; idx &lt; variableList.length; ++idx) &#123;</div><div class="line">          unHoverBin(variableList[idx]);</div><div class="line">        &#125;</div><div class="line">      &#125;)</div><div class="line">      .on('click', // multiClicker([</div><div class="line">        function singleClick(d, i) &#123; // single click handler</div><div class="line">          const overCoords = d3.mouse(model.container);</div><div class="line">          const info = findGroupAndBin(overCoords);</div><div class="line">          if (info.radius &gt; veryOutermostRadius) &#123;</div><div class="line">            showAllChords();</div><div class="line">          &#125; else if (info.radius &gt; outerRadius ||</div><div class="line">              (info.radius &lt;= innerRadius &amp;&amp;</div><div class="line">              pmiChordMode.mode === PMI_CHORD_MODE_ONE_BIN_ALL_VARS &amp;&amp;</div><div class="line">              info.group === pmiChordMode.srcParam)) &#123;</div><div class="line">            if (info.found) &#123;</div><div class="line">              model.renderState.pmiAllBinsTwoVars = null;</div><div class="line">              model.renderState.pmiOneBinAllVars = &#123; group: info.group, bin: info.bin, d, i &#125;;</div><div class="line">              drawPMIOneBinAllVars()(d, i);</div><div class="line">              publicAPI.selectStatusBarText();</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        // &#125;,</div><div class="line">        &#125;)</div><div class="line">      .on('dblclick',</div><div class="line">        function doubleClick(d, i) &#123; // double click handler</div><div class="line">          const overCoords = d3.mouse(model.container);</div><div class="line">          const info = findGroupAndBin(overCoords);</div><div class="line"></div><div class="line">          if (info.found) &#123;</div><div class="line">            let binMap = &#123;&#125;;</div><div class="line">            const oneBinAllVarsMode = info.radius &lt;= innerRadius &amp;&amp; pmiChordMode.mode === PMI_CHORD_MODE_ONE_BIN_ALL_VARS;</div><div class="line">            if (info.radius &lt;= innerRadius) &#123;</div><div class="line">              model.renderState.pmiHighlight = &#123; group: info.group, bin: info.bin, highlight: true, mode: oneBinAllVarsMode &#125;;</div><div class="line">              binMap = findPmiChordsToHighlight();</div><div class="line">            &#125;</div><div class="line">            if (!oneBinAllVarsMode) &#123;</div><div class="line">              binMap[info.group] = [info.bin];</div><div class="line">            &#125;</div><div class="line">            updateActiveSelection(binMap);</div><div class="line">          &#125;</div><div class="line"></div><div class="line">          d3.event.stopPropagation();</div><div class="line">      //   &#125;,</div><div class="line">      // ])</div><div class="line">        &#125;);</div><div class="line">    let miChordsG = svg.select('g.mutualInfoChords');</div><div class="line">    if (miChordsG.empty()) &#123;</div><div class="line">      svg.append('circle').attr('r', outerRadius);</div><div class="line">      miChordsG = svg.append('g').classed('mutualInfoChords', true);</div><div class="line">      svg.append('g').classed('pmiChords', true);</div><div class="line"></div><div class="line">      // add a straight path so IE/Edge can measure text lengths usefully.</div><div class="line">      // Otherwise, along a curved path, they return the horizontal space covered.</div><div class="line">      svg.append('defs').append('path')</div><div class="line">        .attr('id', 'straight-text-path')</div><div class="line">        .attr('d', `M0,0L$&#123;width&#125;,0`);</div><div class="line">    &#125;</div><div class="line">    // Compute the chord layout.</div><div class="line">    layout.matrix(model.mutualInformationData.matrix);</div><div class="line"></div><div class="line">    // Get lookups for pmi chords</div><div class="line">    model.mutualInformationData.lkup = &#123;&#125;;</div><div class="line">    Object.keys(model.mutualInformationData.vmap).forEach((i) =&gt; &#123;</div><div class="line">      model.mutualInformationData.lkup[model.mutualInformationData.vmap[i].name] = i;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    // Only used when there is no legend service</div><div class="line">    const cmap = d3.scale.category20();</div><div class="line"></div><div class="line">    // Add a group per neighborhood.</div><div class="line">    const group = svg</div><div class="line">      .selectAll('.group')</div><div class="line">      .data(layout.groups, () =&gt; &#123; groupID += 1; return groupID; &#125;);</div><div class="line">    const groupEnter = group</div><div class="line">      .enter()</div><div class="line">      .append('g')</div><div class="line">      .classed('group', true)</div><div class="line">      .classed(style.group, true);</div><div class="line"></div><div class="line"></div><div class="line">    // Add the group arc.</div><div class="line">    groupEnter</div><div class="line">      .append('path')</div><div class="line">      .attr('id', (d, i) =&gt; `$&#123;model.instanceID&#125;-group$&#123;i&#125;`);</div><div class="line"></div><div class="line">    // Add a text label.</div><div class="line">    const groupText = groupEnter</div><div class="line">      .append('text')</div><div class="line">      // .attr('x', 6) // prevents ie11 from seeing text-anchor and startOffset.</div><div class="line">      .attr('dy', 15);</div><div class="line"></div><div class="line">    if (!model.textLengthMap) model.textLengthMap = &#123;&#125;;</div><div class="line">    // pull a stunt to measure text length - use a straight path, then switch to the real curved one.</div><div class="line">    const textPath = groupText</div><div class="line">      .append('textPath')</div><div class="line">      .attr('xlink:href', '#straight-text-path')</div><div class="line">      .attr('startOffset', '25%')</div><div class="line">      .text((d, i) =&gt; model.mutualInformationData.vmap[i].name)</div><div class="line">      .each(function textLen(d, i) &#123;</div><div class="line">        model.textLengthMap[model.mutualInformationData.vmap[i].name] = this.getComputedTextLength();</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">    textPath</div><div class="line">      .attr('xlink:href', (d, i) =&gt; `#$&#123;model.instanceID&#125;-group$&#123;i&#125;`);</div><div class="line"></div><div class="line">    // enter + update items.</div><div class="line">    const groupPath = group.select('path')</div><div class="line">      .attr('d', arc);</div><div class="line">    // Remove the labels that don't fit, or shorten label, using ...</div><div class="line">    group</div><div class="line">      .select('text').select('textPath')</div><div class="line">      .each(function truncate(d, i) &#123;</div><div class="line">        d.textShown = true;</div><div class="line">        const availLength = ((groupPath[0][d.index].getTotalLength() / 2) - deltaRadius - model.glyphSize);</div><div class="line">        // shorten text based on string length vs initial total length.</div><div class="line">        const fullText = model.mutualInformationData.vmap[d.index].name;</div><div class="line">        const textLength = model.textLengthMap[fullText];</div><div class="line">        const strLength = fullText.length;</div><div class="line">        // we fit! done.</div><div class="line">        if (textLength &lt;= availLength) &#123;</div><div class="line">          d.textLength = textLength;</div><div class="line">          return;</div><div class="line">        &#125;</div><div class="line">        // if we don't have 15 pixels left, or short string, don't show label.</div><div class="line">        if (availLength &lt; 15 || strLength &lt; 9) &#123;</div><div class="line">          d.textShown = false;</div><div class="line">          return;</div><div class="line">        &#125;</div><div class="line">        // drop the middle 50%.</div><div class="line">        let testStrLen = Math.floor(strLength * 0.25);</div><div class="line">        // estimate new length, +2 to account for adding '...'</div><div class="line">        d.textLength = (((testStrLen * 2) + 2) / strLength) * textLength;</div><div class="line">        if (d.textLength &lt; availLength) &#123;</div><div class="line">          d3.select(this).text(`$&#123;fullText.slice(0, testStrLen)&#125;...$&#123;fullText.slice(-testStrLen)&#125;`);</div><div class="line">          return;</div><div class="line">        &#125;</div><div class="line">        // start at 1/3 of the string, go down to 3 chars plus ...</div><div class="line">        testStrLen = Math.floor(strLength / 2.99);</div><div class="line">        while (testStrLen &gt;= 3) &#123;</div><div class="line">          d.textLength = ((testStrLen + 2) / strLength) * textLength;</div><div class="line">          if (d.textLength &lt; availLength) &#123;</div><div class="line">            d3.select(this).text(`$&#123;fullText.slice(0, testStrLen)&#125;...`);</div><div class="line">            return;</div><div class="line">          &#125;</div><div class="line">          testStrLen -= 1;</div><div class="line">        &#125;</div><div class="line">        // small string doesn't fit - hide.</div><div class="line">        d.textShown = false;</div><div class="line">      &#125;)</div><div class="line">      .attr('display', (d, i) =&gt; (d.textShown ? null : 'none'));</div><div class="line">      // .remove(); ie11 throws errors if we use .remove() - hide instead.</div><div class="line"></div><div class="line"></div><div class="line">    // Add group for glyph</div><div class="line">    if (getLegend) &#123;</div><div class="line">      group.each(function addLegend(glyphData) &#123;</div><div class="line">        let glyph = d3.select(this).select('g.glyph');</div><div class="line">        if (glyph.empty()) &#123;</div><div class="line">          glyph = d3.select(this)</div><div class="line">            .append('g')</div><div class="line">            .classed('glyph', true)</div><div class="line">            .classed(style.glyph, true);</div><div class="line">          glyph</div><div class="line">            .append('svg')</div><div class="line">            .append('use');</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        const legend = getLegend(model.mutualInformationData.vmap[glyphData.index].name);</div><div class="line">        // Add the glyph to the group</div><div class="line">        const textLength = glyphData.textShown ? glyphData.textLength : 0;</div><div class="line">        const pathLength = groupPath[0][glyphData.index].getTotalLength();</div><div class="line">        const avgRadius = (innerRadius + outerRadius) / 2;</div><div class="line">        // Start at edge of arc, move to text anchor, back up half of text length and glyph size</div><div class="line">        const glyphAngle = (glyphData.startAngle + (pathLength * 0.25 / outerRadius) - ((textLength + model.glyphSize) * 0.5 / avgRadius));</div><div class="line">        // console.log(model.mutualInformationData.vmap[glyphData.index].name, textLength, pathLength, glyphAngle);</div><div class="line"></div><div class="line">        glyph</div><div class="line">          .attr('transform', `translate(</div><div class="line">            $&#123;(avgRadius * Math.sin(glyphAngle)) - (model.glyphSize / 2)&#125;,</div><div class="line">            $&#123;(-avgRadius * Math.cos(glyphAngle)) - (model.glyphSize / 2)&#125;)`)</div><div class="line">          .select('svg')</div><div class="line">          .attr('width', model.glyphSize)</div><div class="line">          .attr('height', model.glyphSize)</div><div class="line">          .attr('stroke', 'black')</div><div class="line">          .attr('fill', legend.color)</div><div class="line">          .select('use')</div><div class="line">          .attr('xlink:href', legend.shape);</div><div class="line"></div><div class="line">        model.mutualInformationData.vmap[glyphData.index].color = legend.color;</div><div class="line"></div><div class="line">        // Remove the glyphs that don't fit</div><div class="line">        if ((groupPath[0][glyphData.index].getTotalLength() / 2) - deltaRadius &lt; model.glyphSize) &#123;</div><div class="line">          // glyph.remove(); ie11 objects, hide instead.</div><div class="line">          glyph.attr('display', 'none');</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function getParamBinRange(index, numberOfBins, paramName) &#123;</div><div class="line">      const paramRange = model.provider.getField(paramName).range;</div><div class="line">      return getBinRange(index, numberOfBins,</div><div class="line">        [paramRange[0], paramRange[1], paramRange[1] - paramRange[0]]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function getBinRange(index, numberOfBins, paramRange) &#123;</div><div class="line">      return [</div><div class="line">        (index / numberOfBins * paramRange[2]) + paramRange[0],</div><div class="line">        ((index + 1) / numberOfBins * paramRange[2]) + paramRange[0],</div><div class="line">      ];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Zip histogram info into layout.groups() (which we initially have no control over as it is</div><div class="line">    // generated for us).</div><div class="line">    group</div><div class="line">      .each(function buildHistogram(groupData) &#123;</div><div class="line">        const gname = model.mutualInformationData.vmap[groupData.index].name;</div><div class="line">        const gvar = model.histogramData[gname];</div><div class="line"></div><div class="line">        if (!gvar) return;</div><div class="line"></div><div class="line">        // Set the color if it hasn't already been set</div><div class="line">        if (!getLegend) &#123;</div><div class="line">          model.mutualInformationData.vmap[groupData.index].color = cmap(groupData.index);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        // Add the color to the group arc</div><div class="line">        d3.select(this)</div><div class="line">          .select('path')</div><div class="line">          .style('fill', model.mutualInformationData.vmap[groupData.index].color || 'red');</div><div class="line"></div><div class="line">        groupData.range = [gvar.min, gvar.max, gvar.max - gvar.min];</div><div class="line"></div><div class="line">        const delta = (groupData.endAngle - groupData.startAngle) / gvar.counts.length;</div><div class="line">        const total = Number(gvar.counts.reduce((a, b) =&gt; a + b));</div><div class="line">        const maxcnt = Number(gvar.counts.reduce((a, b) =&gt; (a &gt; b ? a : b)));</div><div class="line"></div><div class="line">        /* eslint-disable arrow-body-style */</div><div class="line">        groupData.histo = gvar.counts.map((d, i) =&gt; &#123;</div><div class="line">          return &#123;</div><div class="line">            startAngle: ((i * delta) + groupData.startAngle),</div><div class="line">            endAngle: (((i + 1) * delta) + groupData.startAngle),</div><div class="line">            innerRadius: (outerRadius + 10),</div><div class="line">            outerRadius: (outerRadius + 10 + (d / maxcnt * (histoRadius - outerRadius))),</div><div class="line">            index: i,</div><div class="line">            value: (d / total),</div><div class="line">          &#125;;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        const htile = d3.select(this)</div><div class="line">          .attr('param-name', gname)</div><div class="line">          .selectAll('path.htile')</div><div class="line">          .data(groupData.histo);</div><div class="line">        htile</div><div class="line">          .enter()</div><div class="line">          .append('path')</div><div class="line">          .classed('htile', true);</div><div class="line">        htile</div><div class="line">          .attr('d', (d, i) =&gt; histoArc.outerRadius(d.outerRadius)(d))</div><div class="line">          .attr('data-details', (d, i) =&gt; &#123;</div><div class="line">            const binRange = getBinRange(i, histogram1DnumberOfBins, groupData.range);</div><div class="line">            return `p($&#123;gname&#125; ∈ [$&#123;formatVal(binRange[0])&#125;, $&#123;formatVal(binRange[1])&#125;]) = $&#123;formatPercent(d.value)&#125;`;</div><div class="line">          &#125;)</div><div class="line">          .attr('fill', (d, i) =&gt; (i % 2 ? '#bebebe' : '#a9a9a9'));</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">    function showAllChords() &#123;</div><div class="line">      pmiChordMode.mode = PMI_CHORD_MODE_NONE;</div><div class="line">      pmiChordMode.srcParam = null;</div><div class="line">      pmiChordMode.srcBin = null;</div><div class="line">      pmiChordMode.miIndex = -1;</div><div class="line">      updateChordVisibility(&#123; mi: &#123; show: true &#125; &#125;);</div><div class="line">    &#125;</div><div class="line">    // do we need to reset?</div><div class="line">    const groupExit = group.exit();</div><div class="line">    const needReset = (!groupEnter.empty() || !groupExit.empty());</div><div class="line">    groupExit.remove();</div><div class="line"></div><div class="line">    // Add the chords. Color only chords that show self-mutual-information.</div><div class="line">    const chord = miChordsG</div><div class="line">      .selectAll('.chord')</div><div class="line">      .data(layout.chords);</div><div class="line">    chord</div><div class="line">      .enter()</div><div class="line">      .append('path')</div><div class="line">      .classed('chord', true)</div><div class="line">      .classed(style.chord, true);</div><div class="line"></div><div class="line">    chord.exit().remove();</div><div class="line"></div><div class="line">    chord</div><div class="line">      .classed('selfchord', d =&gt; (d.source.index === d.target.index))</div><div class="line">      .attr('d', path)</div><div class="line">      .style('fill', null)</div><div class="line">      .on('click', (d, i) =&gt; &#123;</div><div class="line">        model.renderState.pmiOneBinAllVars = null;</div><div class="line">        model.renderState.pmiAllBinsTwoVars = &#123; d, i &#125;;</div><div class="line">        drawPMIAllBinsTwoVars();</div><div class="line">        publicAPI.selectStatusBarText();</div><div class="line">      &#125;)</div><div class="line">      .on('mouseover', function inner(d, i) &#123;</div><div class="line">        publicAPI.updateStatusBarText(d3.select(this).attr('data-details'));</div><div class="line">      &#125;)</div><div class="line">      .on('mouseout', () =&gt; &#123;</div><div class="line">        publicAPI.updateStatusBarText('');</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">    miChordsG</div><div class="line">      .selectAll('.selfchord')</div><div class="line">      .style('fill', d =&gt; model.mutualInformationData.vmap[d.source.index].color);</div><div class="line"></div><div class="line">    chord</div><div class="line">      .attr('data-details', (d, i) =&gt;</div><div class="line">        `Mutual information: $&#123;model.mutualInformationData.vmap[d.source.index].name&#125; ↔︎ $&#123;model.mutualInformationData.vmap[d.target.index].name&#125; `</div><div class="line">        + `$&#123;formatMI(model.mutualInformationData.matrix[d.source.index][d.target.index])&#125;`);</div><div class="line">    // The lines below are for the case when the MI matrix has been row-normalized:</div><div class="line">    // model.mutualInformationData.matrix[d.source.index][d.target.index] *</div><div class="line">    // model.mutualInformationData.vmap[d.source.index].autoInfo/model.mutualInformationData.matrix[d.source.index][d.source.index]);</div><div class="line"></div><div class="line">    // after chord is defined.</div><div class="line">    if (needReset) &#123;</div><div class="line">      showAllChords();</div><div class="line">      publicAPI.updateStatusBarText('');</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    svg</div><div class="line">      .selectAll(`g.group path[id^=\'$&#123;model.instanceID&#125;-group\']`)</div><div class="line">      .on('click', (d, i) =&gt; &#123;</div><div class="line">        if (pmiChordMode.mode !== PMI_CHORD_MODE_NONE || pmiChordMode.miIndex !== i) &#123;</div><div class="line">          pmiChordMode.mode = PMI_CHORD_MODE_NONE;</div><div class="line">          pmiChordMode.srcParam = null;</div><div class="line">          pmiChordMode.srcBin = null;</div><div class="line">          pmiChordMode.miIndex = i;</div><div class="line">          updateChordVisibility(&#123; mi: &#123; show: true, index: i &#125; &#125;);</div><div class="line">        &#125; else &#123;</div><div class="line">          showAllChords();</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">    if (model.renderState.pmiAllBinsTwoVars !== null) &#123;</div><div class="line">      drawPMIAllBinsTwoVars();</div><div class="line">    &#125; else if (model.renderState.pmiOneBinAllVars !== null) &#123;</div><div class="line">      const &#123; group: g, bin: b, d, i &#125; = model.renderState.pmiOneBinAllVars;</div><div class="line">      drawPMIOneBinAllVars(g, b)(d, i);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if (model.renderState.pmiHighlight !== null) &#123;</div><div class="line">      findPmiChordsToHighlight();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    function drawPMIOneBinAllVars() &#123;</div><div class="line">      var binVar = model.renderState.pmiOneBinAllVars.group; // Hold on to the name of the variable whose bin we should draw.</div><div class="line">      var binIdx = model.renderState.pmiOneBinAllVars.bin;</div><div class="line"></div><div class="line">      pmiChordMode.mode = PMI_CHORD_MODE_ONE_BIN_ALL_VARS;</div><div class="line">      pmiChordMode.srcParam = binVar;</div><div class="line">      pmiChordMode.srcBin = binIdx;</div><div class="line"></div><div class="line">      // Return a function that, given a bin datum, renders the highest PMI (or probability)</div><div class="line">      // links from that bin to any/all other bins in other variables it co-occurs with.</div><div class="line">      return (d, i) =&gt; &#123;</div><div class="line">        // Turn off MI rendering</div><div class="line">        chord.classed('fade', true);</div><div class="line"></div><div class="line">        // Turn on PMI rendering</div><div class="line">        let linkAccum = [];</div><div class="line">        Object.keys(model.mutualInformationData.vmap).forEach((iother) =&gt; &#123;</div><div class="line">          var other = model.mutualInformationData.vmap[iother];</div><div class="line">          let va = binVar;</div><div class="line">          let vb = other.name;</div><div class="line">          if (!vb || vb === va) &#123;</div><div class="line">            return; // Can't draw links to self...</div><div class="line">          &#125;</div><div class="line">          let swap = false;</div><div class="line">          if (vb &lt; va) &#123;</div><div class="line">            const tmp = vb;</div><div class="line">            vb = va;</div><div class="line">            va = tmp;</div><div class="line">            swap = true;</div><div class="line">          &#125;</div><div class="line"></div><div class="line">          const cAB = downsample(model.mutualInformationData.joint[va][vb], histogram1DnumberOfBins, swap);</div><div class="line">          const probDict = freqToProb(cAB);</div><div class="line">          const linksToDraw = topBinPmi(probDict, true, binIdx, 0.8);</div><div class="line">          linkAccum = linkAccum.concat(</div><div class="line">            d3.zip(</div><div class="line">              linksToDraw.idx, linksToDraw.pmi, linksToDraw.pAB,</div><div class="line">              new Array(linksToDraw.idx.length).fill([binVar, other.name])</div><div class="line">            )</div><div class="line">          );</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        // Make mutual info chords invisible.</div><div class="line">        svg.selectAll('g.group path.chord')</div><div class="line">          .classed('fade', true);</div><div class="line"></div><div class="line">        const linkData = svg</div><div class="line">          .select('g.pmiChords')</div><div class="line">          .selectAll('path.pmiChord')</div><div class="line">          .data(linkAccum);</div><div class="line"></div><div class="line">        linkData.enter().append('path')</div><div class="line">          .classed('pmiChord', true)</div><div class="line">          .classed(style.pmiChord, true);</div><div class="line">        linkData.exit().remove();</div><div class="line"></div><div class="line">        linkData</div><div class="line">          .classed('fade', false)</div><div class="line">          .attr('d', (data, index) =&gt; &#123;</div><div class="line">            var vaGrp = layout.groups()[model.mutualInformationData.lkup[data[3][0]]];</div><div class="line">            var vbGrp = layout.groups()[model.mutualInformationData.lkup[data[3][1]]];</div><div class="line">            var vaRange = [vaGrp.startAngle, (vaGrp.endAngle - vaGrp.startAngle), (vaGrp.endAngle - vaGrp.startAngle) / histogram1DnumberOfBins];</div><div class="line">            var vbRange = [vbGrp.startAngle, (vbGrp.endAngle - vbGrp.startAngle), (vbGrp.endAngle - vbGrp.startAngle) / histogram1DnumberOfBins];</div><div class="line">            return path(&#123;</div><div class="line">              source: &#123;</div><div class="line">                startAngle: (vaRange[0] + (data[0][0] * vaRange[2])),</div><div class="line">                endAngle: (vaRange[0] + ((data[0][0] + 1) * vaRange[2])),</div><div class="line">              &#125;,</div><div class="line">              target: &#123;</div><div class="line">                startAngle: (vbRange[0] + (data[0][1] * vbRange[2])),</div><div class="line">                endAngle: (vbRange[0] + ((data[0][1] + 1) * vbRange[2])),</div><div class="line">              &#125;,</div><div class="line">            &#125;);</div><div class="line">          &#125;)</div><div class="line">          .attr('data-source-name', data =&gt; data[3][0])</div><div class="line">          .attr('data-source-bin', data =&gt; data[0][0])</div><div class="line">          .attr('data-target-name', data =&gt; data[3][1])</div><div class="line">          .attr('data-target-bin', data =&gt; data[0][1])</div><div class="line">          .classed('highlight-pmi', false)</div><div class="line">          .classed('positive', data =&gt; data[1] &gt;= 0.0)</div><div class="line">          .classed('negative', data =&gt; data[1] &lt; 0.0)</div><div class="line">          .attr('data-details', (data) =&gt; &#123;</div><div class="line">            const sourceBinRange = getParamBinRange(data[0][0], histogram1DnumberOfBins, data[3][0]);</div><div class="line">            const targetBinRange = getParamBinRange(data[0][1], histogram1DnumberOfBins, data[3][1]);</div><div class="line">            return 'PMI: '</div><div class="line">              + `$&#123;data[3][0]&#125; ∈ [ $&#123;formatVal(sourceBinRange[0])&#125;, $&#123;formatVal(sourceBinRange[1])&#125;] ↔︎ `</div><div class="line">              + `$&#123;data[3][1]&#125; ∈ [ $&#123;formatVal(targetBinRange[0])&#125;, $&#123;formatVal(targetBinRange[1])&#125;] $&#123;formatMI(data[1])&#125;`;</div><div class="line">          &#125;)</div><div class="line">          .on('mouseover', function mouseOver() &#123;</div><div class="line">            publicAPI.updateStatusBarText(d3.select(this).attr('data-details'));</div><div class="line">          &#125;)</div><div class="line">          .on('mouseout', () =&gt; &#123;</div><div class="line">            publicAPI.updateStatusBarText('');</div><div class="line">          &#125;)</div><div class="line">          .on('click', () =&gt; &#123; publicAPI.selectStatusBarText(); &#125;);</div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  function handleHoverUpdate(data) &#123;</div><div class="line">    const svg = d3.select(model.container);</div><div class="line">    Object.keys(data.state).forEach((pName) =&gt; &#123;</div><div class="line">      const binList = data.state[pName];</div><div class="line">      svg.selectAll(`g.group[param-name='$&#123;pName&#125;'] &gt; path.htile`)</div><div class="line">        .classed('hilite', (d, i) =&gt;</div><div class="line">          binList.indexOf(-1) === -1 &amp;&amp; binList.indexOf(i) &gt;= 0</div><div class="line">        );</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  // Make sure default values get applied</div><div class="line">  publicAPI.setContainer(model.container);</div><div class="line"></div><div class="line">  model.subscriptions.push(&#123; unsubscribe: publicAPI.setContainer &#125;);</div><div class="line">  model.subscriptions.push(model.provider.onFieldChange(() =&gt; &#123;</div><div class="line">    model.renderState = &#123;</div><div class="line">      pmiAllBinsTwoVars: null,</div><div class="line">      pmiOneBinAllVars: null,</div><div class="line">      pmiHighlight: null,</div><div class="line">    &#125;;</div><div class="line">    if (model.provider.setMutualInformationParameterNames) &#123;</div><div class="line">      model.provider.setMutualInformationParameterNames(model.provider.getActiveFieldNames());</div><div class="line">    &#125;</div><div class="line">  &#125;));</div><div class="line"></div><div class="line">  if (model.provider.isA('Histogram1DProvider')) &#123;</div><div class="line">    model.histogram1DDataSubscription = model.provider.subscribeToHistogram1D(</div><div class="line">      (data) =&gt; &#123;</div><div class="line">        model.histogramData = data;</div><div class="line">        publicAPI.render();</div><div class="line">      &#125;,</div><div class="line">      model.provider.getFieldNames(),</div><div class="line">      &#123;</div><div class="line">        numberOfBins: model.numberOfBins,</div><div class="line">        partial: false,</div><div class="line">      &#125;</div><div class="line">    );</div><div class="line"></div><div class="line">    model.subscriptions.push(model.histogram1DDataSubscription);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  if (model.provider.isA('MutualInformationProvider')) &#123;</div><div class="line">    model.mutualInformationDataSubscription = model.provider.onMutualInformationReady(</div><div class="line">      (data) =&gt; &#123;</div><div class="line">        model.mutualInformationData = data;</div><div class="line">        publicAPI.render();</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">    model.subscriptions.push(model.mutualInformationDataSubscription);</div><div class="line">    model.provider.setMutualInformationParameterNames(model.provider.getActiveFieldNames());</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  if (model.provider.isA('HistogramBinHoverProvider')) &#123;</div><div class="line">    model.subscriptions.push(model.provider.onHoverBinChange(handleHoverUpdate));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  if (model.provider.isA('SelectionProvider')) &#123;</div><div class="line">    model.subscriptions.push(model.provider.onAnnotationChange((annotation) =&gt; &#123;</div><div class="line">      if (lastAnnotationPushed</div><div class="line">        &amp;&amp; annotation.selection.type === 'range'</div><div class="line">        &amp;&amp; annotation.id === lastAnnotationPushed.id</div><div class="line">        &amp;&amp; annotation.generation === lastAnnotationPushed.generation + 1) &#123;</div><div class="line">        // Assume that it is still ours but edited by someone else</div><div class="line">        lastAnnotationPushed = annotation;</div><div class="line">        // Capture the score and update our default</div><div class="line">        model.defaultScore = lastAnnotationPushed.score[0];</div><div class="line">      &#125;</div><div class="line">    &#125;));</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// ----------------------------------------------------------------------------</div><div class="line">// Object factory</div><div class="line">// ----------------------------------------------------------------------------</div><div class="line"></div><div class="line">const DEFAULT_VALUES = &#123;</div><div class="line">  container: null,</div><div class="line">  provider: null,</div><div class="line"></div><div class="line">  needData: true,</div><div class="line"></div><div class="line">  glyphSize: 15,</div><div class="line"></div><div class="line">  statusBarVisible: false,</div><div class="line"></div><div class="line">  useAnnotation: false,</div><div class="line">  defaultScore: 0,</div><div class="line">  defaultWeight: 1,</div><div class="line"></div><div class="line">  numberOfBins: 32,</div><div class="line">&#125;;</div><div class="line"></div><div class="line">// ----------------------------------------------------------------------------</div><div class="line"></div><div class="line">export function extend(publicAPI, model, initialValues = &#123;&#125;) &#123;</div><div class="line">  Object.assign(model, DEFAULT_VALUES, initialValues);</div><div class="line"></div><div class="line">  CompositeClosureHelper.destroy(publicAPI, model);</div><div class="line">  CompositeClosureHelper.isA(publicAPI, model, 'VizComponent');</div><div class="line">  CompositeClosureHelper.get(publicAPI, model, ['provider', 'container', 'numberOfBins']);</div><div class="line">  CompositeClosureHelper.set(publicAPI, model, ['numberOfBins']);</div><div class="line">  CompositeClosureHelper.dynamicArray(publicAPI, model, 'readOnlyFields');</div><div class="line"></div><div class="line">  informationDiagram(publicAPI, model);</div><div class="line">&#125;</div><div class="line"></div><div class="line">// ----------------------------------------------------------------------------</div><div class="line"></div><div class="line">export const newInstance = CompositeClosureHelper.newInstance(extend);</div><div class="line"></div><div class="line">// ----------------------------------------------------------------------------</div><div class="line"></div><div class="line">export default &#123; newInstance, extend &#125;;</div></pre></td></tr></table></figure>
<figure class="highlight js"><figcaption><span>utils.js</span></figcaption><table><tr><td class="code"><pre><div class="line"><span class="comment">// -----------------------------------------------------------------------------------</span></div><div class="line"><span class="comment">// -- Private utility methods for dealing with joint (2d) probability distributions --</span></div><div class="line"><span class="comment">// -----------------------------------------------------------------------------------</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">constantMatrix</span>(<span class="params">ii, jj, entry</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> arr = [];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; ii; ++i) &#123;</div><div class="line">    arr.push([]);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; jj; ++j) &#123;</div><div class="line">      arr[i].push(<span class="literal">null</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">zeros</span>(<span class="params">ii, jj</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> constantMatrix(ii, jj, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">downsample</span>(<span class="params">src, nn, swap</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> hsz = src ? src.length : <span class="number">0</span>;</div><div class="line">  <span class="keyword">var</span> arr;</div><div class="line">  <span class="keyword">if</span> (hsz === <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> [];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (nn &lt; <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">return</span> [];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// assert(hsz === src[0].length);</span></div><div class="line">  <span class="keyword">let</span> tn = <span class="number">1</span>;</div><div class="line">  <span class="keyword">while</span> (tn &lt; nn &amp;&amp; tn &lt; hsz) &#123; tn *= <span class="number">2</span>; &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> stride = hsz / tn;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (stride === <span class="number">1</span> &amp;&amp; !swap) &#123;</div><div class="line">    arr = src;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    arr = zeros(tn, tn);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; hsz; ++i) &#123;</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; hsz; ++j) &#123;</div><div class="line">        arr[<span class="built_in">Math</span>.floor(i / stride)][<span class="built_in">Math</span>.floor(j / stride)] += src[i][j];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (swap) &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; tn; ++i) &#123;</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; tn; ++j) &#123;</div><div class="line">        <span class="keyword">const</span> tmp = arr[i][j];</div><div class="line">        arr[i][j] = arr[j][i];</div><div class="line">        arr[j][i] = tmp;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">freqToProb</span>(<span class="params">src</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> hsz = src ? src.length : <span class="number">0</span>;</div><div class="line">  <span class="keyword">if</span> (hsz === <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> [];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// assert(hsz === src[0].length);</span></div><div class="line"></div><div class="line">  <span class="keyword">let</span> total = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; hsz; ++i) &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; hsz; ++j) &#123;</div><div class="line">      total += src[i][j];</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">const</span> pAB = zeros(hsz, hsz);</div><div class="line">  <span class="keyword">const</span> pA = zeros(hsz, <span class="number">1</span>);</div><div class="line">  <span class="keyword">const</span> pB = zeros(<span class="number">1</span>, hsz);</div><div class="line">  <span class="keyword">const</span> pmi = constantMatrix(hsz, hsz, <span class="literal">null</span>);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; hsz; ++i) &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; hsz; ++j) &#123;</div><div class="line">      <span class="keyword">const</span> p = src[i][j] / total;</div><div class="line">      pAB[i][j] = p;</div><div class="line">      pA[i][<span class="number">0</span>] += p;</div><div class="line">      pB[<span class="number">0</span>][j] += p;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; hsz; ++i) &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; hsz; ++j) &#123;</div><div class="line">      <span class="keyword">const</span> pj = pAB[i][j];</div><div class="line">      <span class="keyword">if</span> (pj &gt; <span class="number">0</span>) &#123;</div><div class="line">        pmi[i][j] = <span class="number">-1</span> * <span class="built_in">Math</span>.log(pj / pA[i][<span class="number">0</span>] / pB[<span class="number">0</span>][j]) / <span class="built_in">Math</span>.log(pj);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123; pAB, pA, pB, <span class="attr">cardinality</span>: total, pmi &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">flattenMatrix</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.concat(b));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">quantile</span>(<span class="params">xx, qq</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> xs = flattenMatrix(xx).sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</div><div class="line">  <span class="keyword">return</span> (xs[<span class="built_in">Math</span>.floor(xs.length * qq)] + xs[<span class="built_in">Math</span>.ceil(xs.length * qq)]) / <span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">matrixFind</span>(<span class="params">xx, condition</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!xx || xx.length &lt; <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">return</span> [];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> nn = xx[<span class="number">0</span>].length;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> xf = flattenMatrix(xx)</div><div class="line">    .reduce(<span class="function">(<span class="params">a, b, i</span>) =&gt;</span> (condition(b, i) ? a.concat([[<span class="built_in">Math</span>.floor(i / nn), i % nn]]) : a),</div><div class="line">    []);</div><div class="line">  <span class="keyword">return</span> xf;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">matrixSubset</span>(<span class="params">mat, isRow, idx</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (isRow) &#123;</div><div class="line">    <span class="keyword">return</span> [mat[idx]]; <span class="comment">// return a "new" matrix that has only one row.</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> mat.map(<span class="function"><span class="params">row</span> =&gt;</span> [row[idx]]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">matrixChoose</span>(<span class="params">xx, idxs</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> idxs.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.concat(xx[b[<span class="number">0</span>]][b[<span class="number">1</span>]]), []);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">topProb</span>(<span class="params">dd, qq</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> qval = quantile(dd.pAB, qq);</div><div class="line">  <span class="keyword">var</span> idxs = matrixFind(dd.pAB, d =&gt; d &gt; qval);</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">pAB</span>: matrixChoose(dd.pAB, idxs),</div><div class="line">    <span class="attr">pmi</span>: matrixChoose(dd.pmi, idxs),</div><div class="line">    <span class="attr">idx</span>: idxs,</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">topPmi</span>(<span class="params">dd, qq</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> apmi = dd.pmi.map(<span class="function"><span class="params">row</span> =&gt;</span> row.map(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">Math</span>.abs(v)));</div><div class="line">  <span class="keyword">var</span> qval = quantile(apmi, qq);</div><div class="line">  <span class="keyword">var</span> idxs = matrixFind(apmi, d =&gt; d &gt; qval);</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">pAB</span>: matrixChoose(dd.pAB, idxs),</div><div class="line">    <span class="attr">pmi</span>: matrixChoose(dd.pmi, idxs),</div><div class="line">    <span class="attr">idx</span>: idxs,</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Return the bins most probably linked to the given bin (above the \a qq quantile line of probability).</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">topBinProb</span>(<span class="params">dd, isA, bin, qq</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> subset = matrixSubset(dd.pAB, !isA, bin);</div><div class="line">  <span class="keyword">var</span> qval = quantile(subset, qq);</div><div class="line">  <span class="keyword">var</span> idxs = matrixFind(subset, d =&gt; d &gt; qval);</div><div class="line"></div><div class="line">  <span class="built_in">console</span>.log(</div><div class="line">    <span class="string">'binprob, isA:'</span>, isA,</div><div class="line">    <span class="string">' bin:'</span>, bin,</div><div class="line">    <span class="string">' idxs:'</span>, idxs,</div><div class="line">    <span class="string">' midx: '</span>, idxs.map(<span class="function"><span class="params">d</span> =&gt;</span> (!isA ? [bin, d[<span class="number">1</span>]] : [bin, d[<span class="number">0</span>]])),</div><div class="line">    <span class="string">' subset: '</span>, subset</div><div class="line">  );</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">pAB</span>: matrixChoose(subset, idxs),</div><div class="line">    <span class="attr">pmi</span>: matrixChoose(matrixSubset(dd.pmi, !isA, bin), idxs),</div><div class="line">    <span class="attr">idx</span>: idxs.map(<span class="function"><span class="params">d</span> =&gt;</span> (!isA ? [bin, d[<span class="number">1</span>]] : [bin, d[<span class="number">0</span>]])),</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">topBinPmi</span>(<span class="params">dd, isA, bin, qq</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> subset = matrixSubset(dd.pmi, !isA, bin);</div><div class="line">  <span class="keyword">var</span> apmi = subset.map(<span class="function"><span class="params">row</span> =&gt;</span> row.map(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">Math</span>.abs(v)));</div><div class="line">  <span class="keyword">var</span> qval = quantile(apmi, qq);</div><div class="line">  <span class="keyword">var</span> idxs = matrixFind(apmi, d =&gt; d &gt; qval);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">pAB</span>: matrixChoose(matrixSubset(dd.pAB, !isA, bin), idxs),</div><div class="line">    <span class="attr">pmi</span>: matrixChoose(subset, idxs),</div><div class="line">    <span class="attr">idx</span>: idxs.map(<span class="function"><span class="params">d</span> =&gt;</span> (!isA ? [bin, d[<span class="number">1</span>]] : [bin, d[<span class="number">0</span>]])),</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">calculateAngleAndRadius</span>(<span class="params">coords, containerDims</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> width = containerDims[<span class="number">0</span>];</div><div class="line">  <span class="keyword">const</span> height = containerDims[<span class="number">1</span>];</div><div class="line">  <span class="keyword">const</span> x = coords[<span class="number">0</span>] - (width / <span class="number">2</span>);</div><div class="line">  <span class="keyword">const</span> y = (height - coords[<span class="number">1</span>]) - (height / <span class="number">2</span>);</div><div class="line">  <span class="comment">// Need straight up in screen space to have angle 0, adjust atan2 args accordingly</span></div><div class="line">  <span class="keyword">let</span> arctangent = -<span class="built_in">Math</span>.atan2(-x, y);</div><div class="line">  <span class="keyword">if</span> (arctangent &lt; <span class="number">0</span>) &#123;</div><div class="line">    arctangent = <span class="built_in">Math</span>.PI + (<span class="built_in">Math</span>.PI + arctangent);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> [arctangent, <span class="built_in">Math</span>.sqrt((x * x) + (y * y))];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  calculateAngleAndRadius,</div><div class="line">  constantMatrix,</div><div class="line">  downsample,</div><div class="line">  flattenMatrix,</div><div class="line">  freqToProb,</div><div class="line">  matrixChoose,</div><div class="line">  matrixFind,</div><div class="line">  matrixSubset,</div><div class="line">  quantile,</div><div class="line">  topBinPmi,</div><div class="line">  topBinProb,</div><div class="line">  topPmi,</div><div class="line">  topProb,</div><div class="line">  zeros,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2016-10-31T17:05:27.774Z" itemprop="dateModified">Last updated: 2016-10-31</time>
                <a href="HistogramSelector.html" class="article-footer-prev" title="HistogramSelector"><i class="fa fa-chevron-left"></i><span>Prev</span></a><a href="ParallelCoordinates.html" class="article-footer-next" title="ParallelCoordinates"><span>Next</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">Contents</strong>
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Source"><span class="toc-text">Source</span></a></li></ol>
              <a href="#" id="article-toc-top">Back to Top</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner"><strong class="sidebar-title">Common/Core</strong><a href="CompositeClosureHelper.html" class="sidebar-link">CompositeClosureHelper</a><a href="LookupTable.html" class="sidebar-link">LookupTable</a><a href="LookupTableManager.html" class="sidebar-link">LookupTableManager</a><strong class="sidebar-title">Common/Misc</strong><a href="AnnotationBuilder.html" class="sidebar-link">AnnotationBuilder</a><a href="CanvasOffscreenBuffer.html" class="sidebar-link">CanvasOffscreenBuffer</a><a href="ColorPalettes.html" class="sidebar-link">ColorPalettes</a><a href="Convert.html" class="sidebar-link">Convert</a><a href="ConvertProxyProperty.html" class="sidebar-link">ConvertProxyProperty</a><a href="Debounce.html" class="sidebar-link">Debounce</a><a href="ImageExporter.html" class="sidebar-link">ImageExporter</a><a href="Loop.html" class="sidebar-link">Loop</a><a href="NumberFormatter.html" class="sidebar-link">NumberFormatter</a><a href="Observable.html" class="sidebar-link">Observable</a><a href="PingPong.html" class="sidebar-link">PingPong</a><a href="SelectionBuilder.html" class="sidebar-link">SelectionBuilder</a><a href="SizeHelper.html" class="sidebar-link">SizeHelper</a><a href="TimeProbeManager.html" class="sidebar-link">TimeProbeManager</a><a href="UUID.html" class="sidebar-link">UUID</a><a href="Validate.html" class="sidebar-link">Validate</a><a href="WebGl.html" class="sidebar-link">WebGl</a><strong class="sidebar-title">Common/State</strong><a href="EqualizerState.html" class="sidebar-link">EqualizerState</a><a href="PipelineState.html" class="sidebar-link">PipelineState</a><a href="ToggleState.html" class="sidebar-link">ToggleState</a><strong class="sidebar-title">Component/Native</strong><a href="BackgroundColor.html" class="sidebar-link">BackgroundColor</a><a href="Composite.html" class="sidebar-link">Composite</a><a href="Spacer.html" class="sidebar-link">Spacer</a><a href="ToggleControl.html" class="sidebar-link">ToggleControl</a><a href="Workbench.html" class="sidebar-link">Workbench</a><strong class="sidebar-title">Component/React</strong><a href="ComponentToReact.html" class="sidebar-link">ComponentToReact</a><a href="ReactAdapter.html" class="sidebar-link">ReactAdapter</a><a href="WorkbenchController.html" class="sidebar-link">WorkbenchController</a><strong class="sidebar-title">IO/Core</strong><a href="CSVReader.html" class="sidebar-link">CSVReader</a><a href="DataManager.html" class="sidebar-link">DataManager</a><a href="GeometryDataModel.html" class="sidebar-link">GeometryDataModel</a><a href="ProcessLauncher.html" class="sidebar-link">ProcessLauncher</a><a href="QueryDataModel.html" class="sidebar-link">QueryDataModel</a><strong class="sidebar-title">IO/Girder</strong><a href="CoreEndpoints.html" class="sidebar-link">CoreEndpoints</a><a href="GirderClientBuilder.html" class="sidebar-link">GirderClientBuilder</a><strong class="sidebar-title">IO/WebSocket</strong><a href="AutobahnConnection.html" class="sidebar-link">AutobahnConnection</a><a href="BinaryImageStream.html" class="sidebar-link">BinaryImageStream</a><a href="ParaViewWebClient.html" class="sidebar-link">ParaViewWebClient</a><a href="SmartConnect.html" class="sidebar-link">SmartConnect</a><strong class="sidebar-title">InfoViz/Core</strong><a href="AnnotationStoreProvider.html" class="sidebar-link">AnnotationStoreProvider</a><a href="D3MultiClick.html" class="sidebar-link">D3MultiClick</a><a href="FieldProvider.html" class="sidebar-link">FieldProvider</a><a href="Histogram1DProvider.html" class="sidebar-link">Histogram1DProvider</a><a href="Histogram2DProvider.html" class="sidebar-link">Histogram2DProvider</a><a href="HistogramBinHoverProvider.html" class="sidebar-link">HistogramBinHoverProvider</a><a href="LegendProvider.html" class="sidebar-link">LegendProvider</a><a href="MutualInformationProvider.html" class="sidebar-link">MutualInformationProvider</a><a href="PartitionProvider.html" class="sidebar-link">PartitionProvider</a><a href="PersistentStateProvider.html" class="sidebar-link">PersistentStateProvider</a><a href="ScoresProvider.html" class="sidebar-link">ScoresProvider</a><a href="SelectionProvider.html" class="sidebar-link">SelectionProvider</a><strong class="sidebar-title">InfoViz/Native</strong><a href="FieldSelector.html" class="sidebar-link">FieldSelector</a><a href="HistogramSelector.html" class="sidebar-link">HistogramSelector</a><a href="MutualInformationDiagram.html" class="sidebar-link current">MutualInformationDiagram</a><a href="ParallelCoordinates.html" class="sidebar-link">ParallelCoordinates</a><strong class="sidebar-title">Interaction/Core</strong><a href="MouseHandler.html" class="sidebar-link">MouseHandler</a><a href="VtkWebMouseListener.html" class="sidebar-link">VtkWebMouseListener</a><strong class="sidebar-title">NativeUI/Canvas</strong><a href="GaussianPieceWiseEditor.html" class="sidebar-link">GaussianPieceWiseEditor</a><a href="LinearPieceWiseEditor.html" class="sidebar-link">LinearPieceWiseEditor</a><a href="RemoteRenderer.html" class="sidebar-link">RemoteRenderer</a><strong class="sidebar-title">NativeUI/Renderers</strong><a href="NativeImageRenderer.html" class="sidebar-link">NativeImageRenderer</a><strong class="sidebar-title">React/CollapsibleControls</strong><a href="CollapsibleControlFactory.html" class="sidebar-link">CollapsibleControlFactory</a><a href="FloatImageControl.html" class="sidebar-link">FloatImageControl</a><a href="LightControl.html" class="sidebar-link">LightControl</a><a href="LookupTableManagerControl.html" class="sidebar-link">LookupTableManagerControl</a><a href="MultiViewControl.html" class="sidebar-link">MultiViewControl</a><a href="PixelOperatorControl.html" class="sidebar-link">PixelOperatorControl</a><a href="PlotlyChartControl.html" class="sidebar-link">PlotlyChartControl</a><a href="ProbeControl.html" class="sidebar-link">ProbeControl</a><a href="QueryDataModelControl.html" class="sidebar-link">QueryDataModelControl</a><a href="TimeFloatImageControl.html" class="sidebar-link">TimeFloatImageControl</a><a href="VolumeControl.html" class="sidebar-link">VolumeControl</a><strong class="sidebar-title">React/Containers</strong><a href="OverlayWindow.html" class="sidebar-link">OverlayWindow</a><strong class="sidebar-title">React/Properties</strong><a href="CellProperty.html" class="sidebar-link">CellProperty</a><a href="CheckboxProperty.html" class="sidebar-link">CheckboxProperty</a><a href="EnumProperty.html" class="sidebar-link">EnumProperty</a><a href="MapProperty.html" class="sidebar-link">MapProperty</a><a href="PropertyFactory.html" class="sidebar-link">PropertyFactory</a><a href="PropertyPanel.html" class="sidebar-link">PropertyPanel</a><a href="SliderProperty.html" class="sidebar-link">SliderProperty</a><strong class="sidebar-title">React/Renderers</strong><a href="GeometryRenderer.html" class="sidebar-link">GeometryRenderer</a><a href="ImageRenderer.html" class="sidebar-link">ImageRenderer</a><a href="MultiLayoutRenderer.html" class="sidebar-link">MultiLayoutRenderer</a><a href="PlotlyRenderer.html" class="sidebar-link">PlotlyRenderer</a><a href="VtkRenderer.html" class="sidebar-link">VtkRenderer</a><strong class="sidebar-title">React/Viewers</strong><a href="AbstractViewerMenu.html" class="sidebar-link">AbstractViewerMenu</a><a href="ChartViewer.html" class="sidebar-link">ChartViewer</a><a href="GeometryViewer.html" class="sidebar-link">GeometryViewer</a><a href="ImageBuilderViewer.html" class="sidebar-link">ImageBuilderViewer</a><a href="LineChartViewer.html" class="sidebar-link">LineChartViewer</a><a href="MultiLayoutViewer.html" class="sidebar-link">MultiLayoutViewer</a><a href="Probe3DViewer.html" class="sidebar-link">Probe3DViewer</a><strong class="sidebar-title">React/Widgets</strong><a href="ActionListWidget.html" class="sidebar-link">ActionListWidget</a><a href="AnnotationEditorWidget.html" class="sidebar-link">AnnotationEditorWidget</a><a href="AnnotationStoreEditorWidget.html" class="sidebar-link">AnnotationStoreEditorWidget</a><a href="ButtonSelectorWidget.html" class="sidebar-link">ButtonSelectorWidget</a><a href="CollapsibleWidget.html" class="sidebar-link">CollapsibleWidget</a><a href="ColorByWidget.html" class="sidebar-link">ColorByWidget</a><a href="ColorMapEditorWidget.html" class="sidebar-link">ColorMapEditorWidget</a><a href="ColorPickerWidget.html" class="sidebar-link">ColorPickerWidget</a><a href="CompositePipelineWidget.html" class="sidebar-link">CompositePipelineWidget</a><a href="ContentEditableWidget.html" class="sidebar-link">ContentEditableWidget</a><a href="Coordinate2DWidget.html" class="sidebar-link">Coordinate2DWidget</a><a href="DoubleSliderWidget.html" class="sidebar-link">DoubleSliderWidget</a><a href="DropDownWidget.html" class="sidebar-link">DropDownWidget</a><a href="EqualizerWidget.html" class="sidebar-link">EqualizerWidget</a><a href="FileBrowserWidget.html" class="sidebar-link">FileBrowserWidget</a><a href="GitTreeWidget.html" class="sidebar-link">GitTreeWidget</a><a href="InlineToggleButtonWidget.html" class="sidebar-link">InlineToggleButtonWidget</a><a href="LayoutsWidget.html" class="sidebar-link">LayoutsWidget</a><a href="LookupTableWidget.html" class="sidebar-link">LookupTableWidget</a><a href="NumberInputWidget.html" class="sidebar-link">NumberInputWidget</a><a href="NumberSliderWidget.html" class="sidebar-link">NumberSliderWidget</a><a href="PieceWiseFunctionEditorWidget.html" class="sidebar-link">PieceWiseFunctionEditorWidget</a><a href="PresetListWidget.html" class="sidebar-link">PresetListWidget</a><a href="ProxyEditorWidget.html" class="sidebar-link">ProxyEditorWidget</a><a href="ProxyPropertyGroupWidget.html" class="sidebar-link">ProxyPropertyGroupWidget</a><a href="QueryDataModelWidget.html" class="sidebar-link">QueryDataModelWidget</a><a href="ResplendentWidget.html" class="sidebar-link">ResplendentWidget</a><a href="ScalarRangeWidget.html" class="sidebar-link">ScalarRangeWidget</a><a href="SelectionEditorWidget.html" class="sidebar-link">SelectionEditorWidget</a><a href="SvgIconWidget.html" class="sidebar-link">SvgIconWidget</a><a href="TextInputWidget.html" class="sidebar-link">TextInputWidget</a><a href="ToggleIconButtonWidget.html" class="sidebar-link">ToggleIconButtonWidget</a><a href="TogglePanelWidget.html" class="sidebar-link">TogglePanelWidget</a><strong class="sidebar-title">Rendering/Chart</strong><a href="Histogram2DPlotlyChartBuilder.html" class="sidebar-link">Histogram2DPlotlyChartBuilder</a><a href="PlotlyChartBuilder.html" class="sidebar-link">PlotlyChartBuilder</a><strong class="sidebar-title">Rendering/Geometry</strong><a href="ThreeGeometryBuilder.html" class="sidebar-link">ThreeGeometryBuilder</a><strong class="sidebar-title">Rendering/Image</strong><a href="AbstractImageBuilder.html" class="sidebar-link">AbstractImageBuilder</a><a href="BinaryDataProberImageBuilder.html" class="sidebar-link">BinaryDataProberImageBuilder</a><a href="CompositeImageBuilder.html" class="sidebar-link">CompositeImageBuilder</a><a href="DataProberImageBuilder.html" class="sidebar-link">DataProberImageBuilder</a><a href="DepthCompositeImageBuilder.html" class="sidebar-link">DepthCompositeImageBuilder</a><a href="DepthImageBuilder.html" class="sidebar-link">DepthImageBuilder</a><a href="FloatDataImageBuilder.html" class="sidebar-link">FloatDataImageBuilder</a><a href="FloatTimeDataImageBuilder.html" class="sidebar-link">FloatTimeDataImageBuilder</a><a href="Histogram2DImageBuilder.html" class="sidebar-link">Histogram2DImageBuilder</a><a href="MagicLensImageBuilder.html" class="sidebar-link">MagicLensImageBuilder</a><a href="MultiColorBySortedCompositeImageBuilder.html" class="sidebar-link">MultiColorBySortedCompositeImageBuilder</a><a href="PixelOperatorImageBuilder.html" class="sidebar-link">PixelOperatorImageBuilder</a><a href="QueryDataModelImageBuilder.html" class="sidebar-link">QueryDataModelImageBuilder</a><a href="SortedCompositeImageBuilder.html" class="sidebar-link">SortedCompositeImageBuilder</a><strong class="sidebar-title">Rendering/Painter</strong><a href="LineChartPainter.html" class="sidebar-link">LineChartPainter</a></div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2016 <a href="http://www.kitware.com" target="_blank">Kitware Inc.</a>
    </div>
    <div id="footer-links">
      <a href="https://github.com/kitware/paraviewweb" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/paraviewweb/docs/" class="mobile-nav-link">Docs</a><a href="/paraviewweb/api/" class="mobile-nav-link">API</a><a href="/paraviewweb/examples/" class="mobile-nav-link">Examples</a><a href="/paraviewweb/applications/" class="mobile-nav-link">Applications</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/kitware/paraviewweb" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">Common/Core</strong><a href="CompositeClosureHelper.html" class="mobile-nav-link">CompositeClosureHelper</a><a href="LookupTable.html" class="mobile-nav-link">LookupTable</a><a href="LookupTableManager.html" class="mobile-nav-link">LookupTableManager</a><strong class="mobile-nav-title">Common/Misc</strong><a href="AnnotationBuilder.html" class="mobile-nav-link">AnnotationBuilder</a><a href="CanvasOffscreenBuffer.html" class="mobile-nav-link">CanvasOffscreenBuffer</a><a href="ColorPalettes.html" class="mobile-nav-link">ColorPalettes</a><a href="Convert.html" class="mobile-nav-link">Convert</a><a href="ConvertProxyProperty.html" class="mobile-nav-link">ConvertProxyProperty</a><a href="Debounce.html" class="mobile-nav-link">Debounce</a><a href="ImageExporter.html" class="mobile-nav-link">ImageExporter</a><a href="Loop.html" class="mobile-nav-link">Loop</a><a href="NumberFormatter.html" class="mobile-nav-link">NumberFormatter</a><a href="Observable.html" class="mobile-nav-link">Observable</a><a href="PingPong.html" class="mobile-nav-link">PingPong</a><a href="SelectionBuilder.html" class="mobile-nav-link">SelectionBuilder</a><a href="SizeHelper.html" class="mobile-nav-link">SizeHelper</a><a href="TimeProbeManager.html" class="mobile-nav-link">TimeProbeManager</a><a href="UUID.html" class="mobile-nav-link">UUID</a><a href="Validate.html" class="mobile-nav-link">Validate</a><a href="WebGl.html" class="mobile-nav-link">WebGl</a><strong class="mobile-nav-title">Common/State</strong><a href="EqualizerState.html" class="mobile-nav-link">EqualizerState</a><a href="PipelineState.html" class="mobile-nav-link">PipelineState</a><a href="ToggleState.html" class="mobile-nav-link">ToggleState</a><strong class="mobile-nav-title">Component/Native</strong><a href="BackgroundColor.html" class="mobile-nav-link">BackgroundColor</a><a href="Composite.html" class="mobile-nav-link">Composite</a><a href="Spacer.html" class="mobile-nav-link">Spacer</a><a href="ToggleControl.html" class="mobile-nav-link">ToggleControl</a><a href="Workbench.html" class="mobile-nav-link">Workbench</a><strong class="mobile-nav-title">Component/React</strong><a href="ComponentToReact.html" class="mobile-nav-link">ComponentToReact</a><a href="ReactAdapter.html" class="mobile-nav-link">ReactAdapter</a><a href="WorkbenchController.html" class="mobile-nav-link">WorkbenchController</a><strong class="mobile-nav-title">IO/Core</strong><a href="CSVReader.html" class="mobile-nav-link">CSVReader</a><a href="DataManager.html" class="mobile-nav-link">DataManager</a><a href="GeometryDataModel.html" class="mobile-nav-link">GeometryDataModel</a><a href="ProcessLauncher.html" class="mobile-nav-link">ProcessLauncher</a><a href="QueryDataModel.html" class="mobile-nav-link">QueryDataModel</a><strong class="mobile-nav-title">IO/Girder</strong><a href="CoreEndpoints.html" class="mobile-nav-link">CoreEndpoints</a><a href="GirderClientBuilder.html" class="mobile-nav-link">GirderClientBuilder</a><strong class="mobile-nav-title">IO/WebSocket</strong><a href="AutobahnConnection.html" class="mobile-nav-link">AutobahnConnection</a><a href="BinaryImageStream.html" class="mobile-nav-link">BinaryImageStream</a><a href="ParaViewWebClient.html" class="mobile-nav-link">ParaViewWebClient</a><a href="SmartConnect.html" class="mobile-nav-link">SmartConnect</a><strong class="mobile-nav-title">InfoViz/Core</strong><a href="AnnotationStoreProvider.html" class="mobile-nav-link">AnnotationStoreProvider</a><a href="D3MultiClick.html" class="mobile-nav-link">D3MultiClick</a><a href="FieldProvider.html" class="mobile-nav-link">FieldProvider</a><a href="Histogram1DProvider.html" class="mobile-nav-link">Histogram1DProvider</a><a href="Histogram2DProvider.html" class="mobile-nav-link">Histogram2DProvider</a><a href="HistogramBinHoverProvider.html" class="mobile-nav-link">HistogramBinHoverProvider</a><a href="LegendProvider.html" class="mobile-nav-link">LegendProvider</a><a href="MutualInformationProvider.html" class="mobile-nav-link">MutualInformationProvider</a><a href="PartitionProvider.html" class="mobile-nav-link">PartitionProvider</a><a href="PersistentStateProvider.html" class="mobile-nav-link">PersistentStateProvider</a><a href="ScoresProvider.html" class="mobile-nav-link">ScoresProvider</a><a href="SelectionProvider.html" class="mobile-nav-link">SelectionProvider</a><strong class="mobile-nav-title">InfoViz/Native</strong><a href="FieldSelector.html" class="mobile-nav-link">FieldSelector</a><a href="HistogramSelector.html" class="mobile-nav-link">HistogramSelector</a><a href="MutualInformationDiagram.html" class="mobile-nav-link current">MutualInformationDiagram</a><a href="ParallelCoordinates.html" class="mobile-nav-link">ParallelCoordinates</a><strong class="mobile-nav-title">Interaction/Core</strong><a href="MouseHandler.html" class="mobile-nav-link">MouseHandler</a><a href="VtkWebMouseListener.html" class="mobile-nav-link">VtkWebMouseListener</a><strong class="mobile-nav-title">NativeUI/Canvas</strong><a href="GaussianPieceWiseEditor.html" class="mobile-nav-link">GaussianPieceWiseEditor</a><a href="LinearPieceWiseEditor.html" class="mobile-nav-link">LinearPieceWiseEditor</a><a href="RemoteRenderer.html" class="mobile-nav-link">RemoteRenderer</a><strong class="mobile-nav-title">NativeUI/Renderers</strong><a href="NativeImageRenderer.html" class="mobile-nav-link">NativeImageRenderer</a><strong class="mobile-nav-title">React/CollapsibleControls</strong><a href="CollapsibleControlFactory.html" class="mobile-nav-link">CollapsibleControlFactory</a><a href="FloatImageControl.html" class="mobile-nav-link">FloatImageControl</a><a href="LightControl.html" class="mobile-nav-link">LightControl</a><a href="LookupTableManagerControl.html" class="mobile-nav-link">LookupTableManagerControl</a><a href="MultiViewControl.html" class="mobile-nav-link">MultiViewControl</a><a href="PixelOperatorControl.html" class="mobile-nav-link">PixelOperatorControl</a><a href="PlotlyChartControl.html" class="mobile-nav-link">PlotlyChartControl</a><a href="ProbeControl.html" class="mobile-nav-link">ProbeControl</a><a href="QueryDataModelControl.html" class="mobile-nav-link">QueryDataModelControl</a><a href="TimeFloatImageControl.html" class="mobile-nav-link">TimeFloatImageControl</a><a href="VolumeControl.html" class="mobile-nav-link">VolumeControl</a><strong class="mobile-nav-title">React/Containers</strong><a href="OverlayWindow.html" class="mobile-nav-link">OverlayWindow</a><strong class="mobile-nav-title">React/Properties</strong><a href="CellProperty.html" class="mobile-nav-link">CellProperty</a><a href="CheckboxProperty.html" class="mobile-nav-link">CheckboxProperty</a><a href="EnumProperty.html" class="mobile-nav-link">EnumProperty</a><a href="MapProperty.html" class="mobile-nav-link">MapProperty</a><a href="PropertyFactory.html" class="mobile-nav-link">PropertyFactory</a><a href="PropertyPanel.html" class="mobile-nav-link">PropertyPanel</a><a href="SliderProperty.html" class="mobile-nav-link">SliderProperty</a><strong class="mobile-nav-title">React/Renderers</strong><a href="GeometryRenderer.html" class="mobile-nav-link">GeometryRenderer</a><a href="ImageRenderer.html" class="mobile-nav-link">ImageRenderer</a><a href="MultiLayoutRenderer.html" class="mobile-nav-link">MultiLayoutRenderer</a><a href="PlotlyRenderer.html" class="mobile-nav-link">PlotlyRenderer</a><a href="VtkRenderer.html" class="mobile-nav-link">VtkRenderer</a><strong class="mobile-nav-title">React/Viewers</strong><a href="AbstractViewerMenu.html" class="mobile-nav-link">AbstractViewerMenu</a><a href="ChartViewer.html" class="mobile-nav-link">ChartViewer</a><a href="GeometryViewer.html" class="mobile-nav-link">GeometryViewer</a><a href="ImageBuilderViewer.html" class="mobile-nav-link">ImageBuilderViewer</a><a href="LineChartViewer.html" class="mobile-nav-link">LineChartViewer</a><a href="MultiLayoutViewer.html" class="mobile-nav-link">MultiLayoutViewer</a><a href="Probe3DViewer.html" class="mobile-nav-link">Probe3DViewer</a><strong class="mobile-nav-title">React/Widgets</strong><a href="ActionListWidget.html" class="mobile-nav-link">ActionListWidget</a><a href="AnnotationEditorWidget.html" class="mobile-nav-link">AnnotationEditorWidget</a><a href="AnnotationStoreEditorWidget.html" class="mobile-nav-link">AnnotationStoreEditorWidget</a><a href="ButtonSelectorWidget.html" class="mobile-nav-link">ButtonSelectorWidget</a><a href="CollapsibleWidget.html" class="mobile-nav-link">CollapsibleWidget</a><a href="ColorByWidget.html" class="mobile-nav-link">ColorByWidget</a><a href="ColorMapEditorWidget.html" class="mobile-nav-link">ColorMapEditorWidget</a><a href="ColorPickerWidget.html" class="mobile-nav-link">ColorPickerWidget</a><a href="CompositePipelineWidget.html" class="mobile-nav-link">CompositePipelineWidget</a><a href="ContentEditableWidget.html" class="mobile-nav-link">ContentEditableWidget</a><a href="Coordinate2DWidget.html" class="mobile-nav-link">Coordinate2DWidget</a><a href="DoubleSliderWidget.html" class="mobile-nav-link">DoubleSliderWidget</a><a href="DropDownWidget.html" class="mobile-nav-link">DropDownWidget</a><a href="EqualizerWidget.html" class="mobile-nav-link">EqualizerWidget</a><a href="FileBrowserWidget.html" class="mobile-nav-link">FileBrowserWidget</a><a href="GitTreeWidget.html" class="mobile-nav-link">GitTreeWidget</a><a href="InlineToggleButtonWidget.html" class="mobile-nav-link">InlineToggleButtonWidget</a><a href="LayoutsWidget.html" class="mobile-nav-link">LayoutsWidget</a><a href="LookupTableWidget.html" class="mobile-nav-link">LookupTableWidget</a><a href="NumberInputWidget.html" class="mobile-nav-link">NumberInputWidget</a><a href="NumberSliderWidget.html" class="mobile-nav-link">NumberSliderWidget</a><a href="PieceWiseFunctionEditorWidget.html" class="mobile-nav-link">PieceWiseFunctionEditorWidget</a><a href="PresetListWidget.html" class="mobile-nav-link">PresetListWidget</a><a href="ProxyEditorWidget.html" class="mobile-nav-link">ProxyEditorWidget</a><a href="ProxyPropertyGroupWidget.html" class="mobile-nav-link">ProxyPropertyGroupWidget</a><a href="QueryDataModelWidget.html" class="mobile-nav-link">QueryDataModelWidget</a><a href="ResplendentWidget.html" class="mobile-nav-link">ResplendentWidget</a><a href="ScalarRangeWidget.html" class="mobile-nav-link">ScalarRangeWidget</a><a href="SelectionEditorWidget.html" class="mobile-nav-link">SelectionEditorWidget</a><a href="SvgIconWidget.html" class="mobile-nav-link">SvgIconWidget</a><a href="TextInputWidget.html" class="mobile-nav-link">TextInputWidget</a><a href="ToggleIconButtonWidget.html" class="mobile-nav-link">ToggleIconButtonWidget</a><a href="TogglePanelWidget.html" class="mobile-nav-link">TogglePanelWidget</a><strong class="mobile-nav-title">Rendering/Chart</strong><a href="Histogram2DPlotlyChartBuilder.html" class="mobile-nav-link">Histogram2DPlotlyChartBuilder</a><a href="PlotlyChartBuilder.html" class="mobile-nav-link">PlotlyChartBuilder</a><strong class="mobile-nav-title">Rendering/Geometry</strong><a href="ThreeGeometryBuilder.html" class="mobile-nav-link">ThreeGeometryBuilder</a><strong class="mobile-nav-title">Rendering/Image</strong><a href="AbstractImageBuilder.html" class="mobile-nav-link">AbstractImageBuilder</a><a href="BinaryDataProberImageBuilder.html" class="mobile-nav-link">BinaryDataProberImageBuilder</a><a href="CompositeImageBuilder.html" class="mobile-nav-link">CompositeImageBuilder</a><a href="DataProberImageBuilder.html" class="mobile-nav-link">DataProberImageBuilder</a><a href="DepthCompositeImageBuilder.html" class="mobile-nav-link">DepthCompositeImageBuilder</a><a href="DepthImageBuilder.html" class="mobile-nav-link">DepthImageBuilder</a><a href="FloatDataImageBuilder.html" class="mobile-nav-link">FloatDataImageBuilder</a><a href="FloatTimeDataImageBuilder.html" class="mobile-nav-link">FloatTimeDataImageBuilder</a><a href="Histogram2DImageBuilder.html" class="mobile-nav-link">Histogram2DImageBuilder</a><a href="MagicLensImageBuilder.html" class="mobile-nav-link">MagicLensImageBuilder</a><a href="MultiColorBySortedCompositeImageBuilder.html" class="mobile-nav-link">MultiColorBySortedCompositeImageBuilder</a><a href="PixelOperatorImageBuilder.html" class="mobile-nav-link">PixelOperatorImageBuilder</a><a href="QueryDataModelImageBuilder.html" class="mobile-nav-link">QueryDataModelImageBuilder</a><a href="SortedCompositeImageBuilder.html" class="mobile-nav-link">SortedCompositeImageBuilder</a><strong class="mobile-nav-title">Rendering/Painter</strong><a href="LineChartPainter.html" class="mobile-nav-link">LineChartPainter</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="api/MutualInformationDiagram.html">
      
        <option value="en" selected>English</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/paraviewweb/js/lang_select.js"></script>
<script src="/paraviewweb/js/toc.js"></script>
<script src="/paraviewweb/js/mobile_nav.js"></script>
<!-- endbuild -->
<script src="https://cdn.jsdelivr.net/retinajs/1.3.0/retina.min.js" async></script>



</body>
</html>